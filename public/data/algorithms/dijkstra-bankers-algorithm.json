{
  "slug": "dijkstra-bankers-algorithm",
  "name": "Dijkstra Bankers Algorithm",
  "categories": [
    "others"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "other\\dijkstra_bankers_algorithm.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/other\\dijkstra_bankers_algorithm.py",
      "code": "<span class=\"hljs-comment\"># A Python implementation of the Banker&#x27;s Algorithm in Operating Systems using</span>\r\n<span class=\"hljs-comment\"># Processes and Resources</span>\r\n<span class=\"hljs-comment\"># {</span>\r\n<span class=\"hljs-comment\"># &quot;Author: &quot;Biney Kingsley (bluedistro@github.io), bineykingsley36@gmail.com&quot;,</span>\r\n<span class=\"hljs-comment\"># &quot;Date&quot;: 28-10-2018</span>\r\n<span class=\"hljs-comment\"># }</span>\r\n<span class=\"hljs-string\">&quot;&quot;&quot;\r\nThe Banker&#x27;s algorithm is a resource allocation and deadlock avoidance algorithm\r\ndeveloped by Edsger Dijkstra that tests for safety by simulating the allocation of\r\npredetermined maximum possible amounts of all resources, and then makes a &quot;s-state&quot;\r\ncheck to test for possible deadlock conditions for all other pending activities,\r\nbefore deciding whether allocation should be allowed to continue.\r\n[Source] Wikipedia\r\n[Credit] Rosetta Code C implementation helped very much.\r\n (https://rosettacode.org/wiki/Banker%27s_algorithm)\r\n&quot;&quot;&quot;</span>\r\n\r\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\r\n\r\n<span class=\"hljs-keyword\">import</span> time\r\n\r\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\r\n\r\ntest_claim_vector = [<span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">9</span>, <span class=\"hljs-number\">7</span>]\r\ntest_allocated_res_table = [\r\n    [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>],\r\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>],\r\n    [<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">3</span>],\r\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>],\r\n    [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">0</span>],\r\n]\r\ntest_maximum_claim_table = [\r\n    [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">4</span>],\r\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">2</span>],\r\n    [<span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">5</span>],\r\n    [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">0</span>],\r\n    [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">3</span>],\r\n]\r\n\r\n\r\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BankersAlgorithm</span>:\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">\r\n        self,\r\n        claim_vector: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>],\r\n        allocated_resources_table: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]],\r\n        maximum_claim_table: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]],\r\n    </span>) -&gt; <span class=\"hljs-literal\">None</span>:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        :param claim_vector: A nxn/nxm list depicting the amount of each resources\r\n         (eg. memory, interface, semaphores, etc.) available.\r\n        :param allocated_resources_table: A nxn/nxm list depicting the amount of each\r\n         resource each process is currently holding\r\n        :param maximum_claim_table: A nxn/nxm list depicting how much of each resource\r\n         the system currently has available\r\n        &quot;&quot;&quot;</span>\r\n        self.__claim_vector = claim_vector\r\n        self.__allocated_resources_table = allocated_resources_table\r\n        self.__maximum_claim_table = maximum_claim_table\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__processes_resource_summation</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        Check for allocated resources in line with each resource in the claim vector\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-keyword\">return</span> [\r\n            <span class=\"hljs-built_in\">sum</span>(p_item[i] <span class=\"hljs-keyword\">for</span> p_item <span class=\"hljs-keyword\">in</span> self.__allocated_resources_table)\r\n            <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(self.__allocated_resources_table[<span class=\"hljs-number\">0</span>]))\r\n        ]\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__available_resources</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        Check for available resources in line with each resource in the claim vector\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-keyword\">return</span> np.array(self.__claim_vector) - np.array(\r\n            self.__processes_resource_summation()\r\n        )\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__need</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]]:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        Implement safety checker that calculates the needs by ensuring that\r\n        max_claim[i][j] - alloc_table[i][j] &lt;= avail[j]\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-keyword\">return</span> [\r\n            <span class=\"hljs-built_in\">list</span>(np.array(self.__maximum_claim_table[i]) - np.array(allocated_resource))\r\n            <span class=\"hljs-keyword\">for</span> i, allocated_resource <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">enumerate</span>(self.__allocated_resources_table)\r\n        ]\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__need_index_manager</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">dict</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]]:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        This function builds an index control dictionary to track original ids/indices\r\n        of processes when altered during execution of method &quot;main&quot;\r\n            Return: {0: [a: int, b: int], 1: [c: int, d: int]}\r\n        &gt;&gt;&gt; (BankersAlgorithm(test_claim_vector, test_allocated_res_table,\r\n        ...     test_maximum_claim_table)._BankersAlgorithm__need_index_manager()\r\n        ...     )  # doctest: +NORMALIZE_WHITESPACE\r\n        {0: [1, 2, 0, 3], 1: [0, 1, 3, 1], 2: [1, 1, 0, 2], 3: [1, 3, 2, 0],\r\n         4: [2, 0, 0, 3]}\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-keyword\">return</span> {self.__need().index(i): i <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> self.__need()}\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>(<span class=\"hljs-params\">self, **kwargs</span>) -&gt; <span class=\"hljs-literal\">None</span>:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        Utilize various methods in this class to simulate the Banker&#x27;s algorithm\r\n        Return: None\r\n        &gt;&gt;&gt; BankersAlgorithm(test_claim_vector, test_allocated_res_table,\r\n        ...    test_maximum_claim_table).main(describe=True)\r\n                 Allocated Resource Table\r\n        P1       2        0        1        1\r\n        &lt;BLANKLINE&gt;\r\n        P2       0        1        2        1\r\n        &lt;BLANKLINE&gt;\r\n        P3       4        0        0        3\r\n        &lt;BLANKLINE&gt;\r\n        P4       0        2        1        0\r\n        &lt;BLANKLINE&gt;\r\n        P5       1        0        3        0\r\n        &lt;BLANKLINE&gt;\r\n                 System Resource Table\r\n        P1       3        2        1        4\r\n        &lt;BLANKLINE&gt;\r\n        P2       0        2        5        2\r\n        &lt;BLANKLINE&gt;\r\n        P3       5        1        0        5\r\n        &lt;BLANKLINE&gt;\r\n        P4       1        5        3        0\r\n        &lt;BLANKLINE&gt;\r\n        P5       3        0        3        3\r\n        &lt;BLANKLINE&gt;\r\n        Current Usage by Active Processes: 8 5 9 7\r\n        Initial Available Resources:       1 2 2 2\r\n        __________________________________________________\r\n        &lt;BLANKLINE&gt;\r\n        Process 3 is executing.\r\n        Updated available resource stack for processes: 5 2 2 5\r\n        The process is in a safe state.\r\n        &lt;BLANKLINE&gt;\r\n        Process 1 is executing.\r\n        Updated available resource stack for processes: 7 2 3 6\r\n        The process is in a safe state.\r\n        &lt;BLANKLINE&gt;\r\n        Process 2 is executing.\r\n        Updated available resource stack for processes: 7 3 5 7\r\n        The process is in a safe state.\r\n        &lt;BLANKLINE&gt;\r\n        Process 4 is executing.\r\n        Updated available resource stack for processes: 7 5 6 7\r\n        The process is in a safe state.\r\n        &lt;BLANKLINE&gt;\r\n        Process 5 is executing.\r\n        Updated available resource stack for processes: 8 5 9 7\r\n        The process is in a safe state.\r\n        &lt;BLANKLINE&gt;\r\n        &quot;&quot;&quot;</span>\r\n        need_list = self.__need()\r\n        alloc_resources_table = self.__allocated_resources_table\r\n        available_resources = self.__available_resources()\r\n        need_index_manager = self.__need_index_manager()\r\n        <span class=\"hljs-keyword\">for</span> kw, val <span class=\"hljs-keyword\">in</span> kwargs.items():\r\n            <span class=\"hljs-keyword\">if</span> kw <span class=\"hljs-keyword\">and</span> val <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">True</span>:\r\n                self.__pretty_data()\r\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;_&quot;</span> * <span class=\"hljs-number\">50</span> + <span class=\"hljs-string\">&quot;\\n&quot;</span>)\r\n        <span class=\"hljs-keyword\">while</span> need_list:\r\n            safe = <span class=\"hljs-literal\">False</span>\r\n            <span class=\"hljs-keyword\">for</span> each_need <span class=\"hljs-keyword\">in</span> need_list:\r\n                execution = <span class=\"hljs-literal\">True</span>\r\n                <span class=\"hljs-keyword\">for</span> index, need <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">enumerate</span>(each_need):\r\n                    <span class=\"hljs-keyword\">if</span> need &gt; available_resources[index]:\r\n                        execution = <span class=\"hljs-literal\">False</span>\r\n                        <span class=\"hljs-keyword\">break</span>\r\n                <span class=\"hljs-keyword\">if</span> execution:\r\n                    safe = <span class=\"hljs-literal\">True</span>\r\n                    <span class=\"hljs-comment\"># get the original index of the process from ind_ctrl db</span>\r\n                    <span class=\"hljs-keyword\">for</span> original_need_index, need_clone <span class=\"hljs-keyword\">in</span> need_index_manager.items():\r\n                        <span class=\"hljs-keyword\">if</span> each_need == need_clone:\r\n                            process_number = original_need_index\r\n                    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;Process <span class=\"hljs-subst\">{process_number + <span class=\"hljs-number\">1</span>}</span> is executing.&quot;</span>)\r\n                    <span class=\"hljs-comment\"># remove the process run from stack</span>\r\n                    need_list.remove(each_need)\r\n                    <span class=\"hljs-comment\"># update available/freed resources stack</span>\r\n                    available_resources = np.array(available_resources) + np.array(\r\n                        alloc_resources_table[process_number]\r\n                    )\r\n                    <span class=\"hljs-built_in\">print</span>(\r\n                        <span class=\"hljs-string\">&quot;Updated available resource stack for processes: &quot;</span>\r\n                        + <span class=\"hljs-string\">&quot; &quot;</span>.join([<span class=\"hljs-built_in\">str</span>(x) <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> available_resources])\r\n                    )\r\n                    <span class=\"hljs-keyword\">break</span>\r\n            <span class=\"hljs-keyword\">if</span> safe:\r\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;The process is in a safe state.\\n&quot;</span>)\r\n            <span class=\"hljs-keyword\">else</span>:\r\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;System in unsafe state. Aborting...\\n&quot;</span>)\r\n                <span class=\"hljs-keyword\">break</span>\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__pretty_data</span>(<span class=\"hljs-params\">self</span>):\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        Properly align display of the algorithm&#x27;s solution\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot; &quot;</span> * <span class=\"hljs-number\">9</span> + <span class=\"hljs-string\">&quot;Allocated Resource Table&quot;</span>)\r\n        <span class=\"hljs-keyword\">for</span> item <span class=\"hljs-keyword\">in</span> self.__allocated_resources_table:\r\n            <span class=\"hljs-built_in\">print</span>(\r\n                <span class=\"hljs-string\">f&quot;P<span class=\"hljs-subst\">{self.__allocated_resources_table.index(item) + <span class=\"hljs-number\">1</span>}</span>&quot;</span>\r\n                + <span class=\"hljs-string\">&quot; &quot;</span>.join(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{it:&gt;<span class=\"hljs-number\">8</span>}</span>&quot;</span> <span class=\"hljs-keyword\">for</span> it <span class=\"hljs-keyword\">in</span> item)\r\n                + <span class=\"hljs-string\">&quot;\\n&quot;</span>\r\n            )\r\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot; &quot;</span> * <span class=\"hljs-number\">9</span> + <span class=\"hljs-string\">&quot;System Resource Table&quot;</span>)\r\n        <span class=\"hljs-keyword\">for</span> item <span class=\"hljs-keyword\">in</span> self.__maximum_claim_table:\r\n            <span class=\"hljs-built_in\">print</span>(\r\n                <span class=\"hljs-string\">f&quot;P<span class=\"hljs-subst\">{self.__maximum_claim_table.index(item) + <span class=\"hljs-number\">1</span>}</span>&quot;</span>\r\n                + <span class=\"hljs-string\">&quot; &quot;</span>.join(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{it:&gt;<span class=\"hljs-number\">8</span>}</span>&quot;</span> <span class=\"hljs-keyword\">for</span> it <span class=\"hljs-keyword\">in</span> item)\r\n                + <span class=\"hljs-string\">&quot;\\n&quot;</span>\r\n            )\r\n        <span class=\"hljs-built_in\">print</span>(\r\n            <span class=\"hljs-string\">&quot;Current Usage by Active Processes: &quot;</span>\r\n            + <span class=\"hljs-string\">&quot; &quot;</span>.join(<span class=\"hljs-built_in\">str</span>(x) <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> self.__claim_vector)\r\n        )\r\n        <span class=\"hljs-built_in\">print</span>(\r\n            <span class=\"hljs-string\">&quot;Initial Available Resources:       &quot;</span>\r\n            + <span class=\"hljs-string\">&quot; &quot;</span>.join(<span class=\"hljs-built_in\">str</span>(x) <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> self.__available_resources())\r\n        )\r\n        time.sleep(<span class=\"hljs-number\">1</span>)\r\n\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n    <span class=\"hljs-keyword\">import</span> doctest\r\n\r\n    doctest.testmod()\r\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 4
    }
  ],
  "explanationUrl": {}
}