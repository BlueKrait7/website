{
  "slug": "burrows-wheeler",
  "name": "Burrows Wheeler",
  "categories": [
    "compression"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "compression\\burrows_wheeler.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/compression\\burrows_wheeler.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\r\nhttps://en.wikipedia.org/wiki/Burrows%E2%80%93Wheeler_transform\r\n\r\nThe Burrowsâ€“Wheeler transform (BWT, also called block-sorting compression)\r\nrearranges a character string into runs of similar characters. This is useful\r\nfor compression, since it tends to be easy to compress a string that has runs\r\nof repeated characters by techniques such as move-to-front transform and\r\nrun-length encoding. More importantly, the transformation is reversible,\r\nwithout needing to store any additional data except the position of the first\r\noriginal character. The BWT is thus a &quot;free&quot; method of improving the efficiency\r\nof text compression algorithms, costing only some extra computation.\r\n&quot;&quot;&quot;</span>\r\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\r\n\r\n<span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> TypedDict\r\n\r\n\r\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BWTTransformDict</span>(<span class=\"hljs-title class_ inherited__\">TypedDict</span>):\r\n    bwt_string: <span class=\"hljs-built_in\">str</span>\r\n    idx_original_string: <span class=\"hljs-built_in\">int</span>\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">all_rotations</span>(<span class=\"hljs-params\">s: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>]:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    :param s: The string that will be rotated len(s) times.\r\n    :return: A list with the rotations.\r\n    :raises TypeError: If s is not an instance of str.\r\n    Examples:\r\n\r\n    &gt;&gt;&gt; all_rotations(&quot;^BANANA|&quot;) # doctest: +NORMALIZE_WHITESPACE\r\n    [&#x27;^BANANA|&#x27;, &#x27;BANANA|^&#x27;, &#x27;ANANA|^B&#x27;, &#x27;NANA|^BA&#x27;, &#x27;ANA|^BAN&#x27;, &#x27;NA|^BANA&#x27;,\r\n    &#x27;A|^BANAN&#x27;, &#x27;|^BANANA&#x27;]\r\n    &gt;&gt;&gt; all_rotations(&quot;a_asa_da_casa&quot;) # doctest: +NORMALIZE_WHITESPACE\r\n    [&#x27;a_asa_da_casa&#x27;, &#x27;_asa_da_casaa&#x27;, &#x27;asa_da_casaa_&#x27;, &#x27;sa_da_casaa_a&#x27;,\r\n    &#x27;a_da_casaa_as&#x27;, &#x27;_da_casaa_asa&#x27;, &#x27;da_casaa_asa_&#x27;, &#x27;a_casaa_asa_d&#x27;,\r\n    &#x27;_casaa_asa_da&#x27;, &#x27;casaa_asa_da_&#x27;, &#x27;asaa_asa_da_c&#x27;, &#x27;saa_asa_da_ca&#x27;,\r\n    &#x27;aa_asa_da_cas&#x27;]\r\n    &gt;&gt;&gt; all_rotations(&quot;panamabanana&quot;) # doctest: +NORMALIZE_WHITESPACE\r\n    [&#x27;panamabanana&#x27;, &#x27;anamabananap&#x27;, &#x27;namabananapa&#x27;, &#x27;amabananapan&#x27;,\r\n    &#x27;mabananapana&#x27;, &#x27;abananapanam&#x27;, &#x27;bananapanama&#x27;, &#x27;ananapanamab&#x27;,\r\n    &#x27;nanapanamaba&#x27;, &#x27;anapanamaban&#x27;, &#x27;napanamabana&#x27;, &#x27;apanamabanan&#x27;]\r\n    &gt;&gt;&gt; all_rotations(5)\r\n    Traceback (most recent call last):\r\n        ...\r\n    TypeError: The parameter s type must be str.\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">isinstance</span>(s, <span class=\"hljs-built_in\">str</span>):\r\n        <span class=\"hljs-keyword\">raise</span> TypeError(<span class=\"hljs-string\">&quot;The parameter s type must be str.&quot;</span>)\r\n\r\n    <span class=\"hljs-keyword\">return</span> [s[i:] + s[:i] <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(s))]\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">bwt_transform</span>(<span class=\"hljs-params\">s: <span class=\"hljs-built_in\">str</span></span>) -&gt; BWTTransformDict:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    :param s: The string that will be used at bwt algorithm\r\n    :return: the string composed of the last char of each row of the ordered\r\n    rotations and the index of the original string at ordered rotations list\r\n    :raises TypeError: If the s parameter type is not str\r\n    :raises ValueError: If the s parameter is empty\r\n    Examples:\r\n\r\n    &gt;&gt;&gt; bwt_transform(&quot;^BANANA&quot;)\r\n    {&#x27;bwt_string&#x27;: &#x27;BNN^AAA&#x27;, &#x27;idx_original_string&#x27;: 6}\r\n    &gt;&gt;&gt; bwt_transform(&quot;a_asa_da_casa&quot;)\r\n    {&#x27;bwt_string&#x27;: &#x27;aaaadss_c__aa&#x27;, &#x27;idx_original_string&#x27;: 3}\r\n    &gt;&gt;&gt; bwt_transform(&quot;panamabanana&quot;)\r\n    {&#x27;bwt_string&#x27;: &#x27;mnpbnnaaaaaa&#x27;, &#x27;idx_original_string&#x27;: 11}\r\n    &gt;&gt;&gt; bwt_transform(4)\r\n    Traceback (most recent call last):\r\n        ...\r\n    TypeError: The parameter s type must be str.\r\n    &gt;&gt;&gt; bwt_transform(&#x27;&#x27;)\r\n    Traceback (most recent call last):\r\n        ...\r\n    ValueError: The parameter s must not be empty.\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">isinstance</span>(s, <span class=\"hljs-built_in\">str</span>):\r\n        <span class=\"hljs-keyword\">raise</span> TypeError(<span class=\"hljs-string\">&quot;The parameter s type must be str.&quot;</span>)\r\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> s:\r\n        <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;The parameter s must not be empty.&quot;</span>)\r\n\r\n    rotations = all_rotations(s)\r\n    rotations.sort()  <span class=\"hljs-comment\"># sort the list of rotations in alphabetically order</span>\r\n    <span class=\"hljs-comment\"># make a string composed of the last char of each rotation</span>\r\n    response: BWTTransformDict = {\r\n        <span class=\"hljs-string\">&quot;bwt_string&quot;</span>: <span class=\"hljs-string\">&quot;&quot;</span>.join([word[-<span class=\"hljs-number\">1</span>] <span class=\"hljs-keyword\">for</span> word <span class=\"hljs-keyword\">in</span> rotations]),\r\n        <span class=\"hljs-string\">&quot;idx_original_string&quot;</span>: rotations.index(s),\r\n    }\r\n    <span class=\"hljs-keyword\">return</span> response\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">reverse_bwt</span>(<span class=\"hljs-params\">bwt_string: <span class=\"hljs-built_in\">str</span>, idx_original_string: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    :param bwt_string: The string returned from bwt algorithm execution\r\n    :param idx_original_string: A 0-based index of the string that was used to\r\n    generate bwt_string at ordered rotations list\r\n    :return: The string used to generate bwt_string when bwt was executed\r\n    :raises TypeError: If the bwt_string parameter type is not str\r\n    :raises ValueError: If the bwt_string parameter is empty\r\n    :raises TypeError: If the idx_original_string type is not int or if not\r\n    possible to cast it to int\r\n    :raises ValueError: If the idx_original_string value is lower than 0 or\r\n    greater than len(bwt_string) - 1\r\n\r\n    &gt;&gt;&gt; reverse_bwt(&quot;BNN^AAA&quot;, 6)\r\n    &#x27;^BANANA&#x27;\r\n    &gt;&gt;&gt; reverse_bwt(&quot;aaaadss_c__aa&quot;, 3)\r\n    &#x27;a_asa_da_casa&#x27;\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, 11)\r\n    &#x27;panamabanana&#x27;\r\n    &gt;&gt;&gt; reverse_bwt(4, 11)\r\n    Traceback (most recent call last):\r\n        ...\r\n    TypeError: The parameter bwt_string type must be str.\r\n    &gt;&gt;&gt; reverse_bwt(&quot;&quot;, 11)\r\n    Traceback (most recent call last):\r\n        ...\r\n    ValueError: The parameter bwt_string must not be empty.\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, &quot;asd&quot;) # doctest: +NORMALIZE_WHITESPACE\r\n    Traceback (most recent call last):\r\n        ...\r\n    TypeError: The parameter idx_original_string type must be int or passive\r\n    of cast to int.\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, -1)\r\n    Traceback (most recent call last):\r\n        ...\r\n    ValueError: The parameter idx_original_string must not be lower than 0.\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, 12) # doctest: +NORMALIZE_WHITESPACE\r\n    Traceback (most recent call last):\r\n        ...\r\n    ValueError: The parameter idx_original_string must be lower than\r\n    len(bwt_string).\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, 11.0)\r\n    &#x27;panamabanana&#x27;\r\n    &gt;&gt;&gt; reverse_bwt(&quot;mnpbnnaaaaaa&quot;, 11.4)\r\n    &#x27;panamabanana&#x27;\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-built_in\">isinstance</span>(bwt_string, <span class=\"hljs-built_in\">str</span>):\r\n        <span class=\"hljs-keyword\">raise</span> TypeError(<span class=\"hljs-string\">&quot;The parameter bwt_string type must be str.&quot;</span>)\r\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> bwt_string:\r\n        <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;The parameter bwt_string must not be empty.&quot;</span>)\r\n    <span class=\"hljs-keyword\">try</span>:\r\n        idx_original_string = <span class=\"hljs-built_in\">int</span>(idx_original_string)\r\n    <span class=\"hljs-keyword\">except</span> ValueError:\r\n        <span class=\"hljs-keyword\">raise</span> TypeError(\r\n            <span class=\"hljs-string\">&quot;The parameter idx_original_string type must be int or passive&quot;</span>\r\n            <span class=\"hljs-string\">&quot; of cast to int.&quot;</span>\r\n        )\r\n    <span class=\"hljs-keyword\">if</span> idx_original_string &lt; <span class=\"hljs-number\">0</span>:\r\n        <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;The parameter idx_original_string must not be lower than 0.&quot;</span>)\r\n    <span class=\"hljs-keyword\">if</span> idx_original_string &gt;= <span class=\"hljs-built_in\">len</span>(bwt_string):\r\n        <span class=\"hljs-keyword\">raise</span> ValueError(\r\n            <span class=\"hljs-string\">&quot;The parameter idx_original_string must be lower than&quot;</span> <span class=\"hljs-string\">&quot; len(bwt_string).&quot;</span>\r\n        )\r\n\r\n    ordered_rotations = [<span class=\"hljs-string\">&quot;&quot;</span>] * <span class=\"hljs-built_in\">len</span>(bwt_string)\r\n    <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(bwt_string)):\r\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(bwt_string)):\r\n            ordered_rotations[i] = bwt_string[i] + ordered_rotations[i]\r\n        ordered_rotations.sort()\r\n    <span class=\"hljs-keyword\">return</span> ordered_rotations[idx_original_string]\r\n\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n    entry_msg = <span class=\"hljs-string\">&quot;Provide a string that I will generate its BWT transform: &quot;</span>\r\n    s = <span class=\"hljs-built_in\">input</span>(entry_msg).strip()\r\n    result = bwt_transform(s)\r\n    <span class=\"hljs-built_in\">print</span>(\r\n        <span class=\"hljs-string\">f&quot;Burrows Wheeler transform for string &#x27;<span class=\"hljs-subst\">{s}</span>&#x27; results &quot;</span>\r\n        <span class=\"hljs-string\">f&quot;in &#x27;<span class=\"hljs-subst\">{result[<span class=\"hljs-string\">&#x27;bwt_string&#x27;</span>]}</span>&#x27;&quot;</span>\r\n    )\r\n    original_string = reverse_bwt(result[<span class=\"hljs-string\">&quot;bwt_string&quot;</span>], result[<span class=\"hljs-string\">&quot;idx_original_string&quot;</span>])\r\n    <span class=\"hljs-built_in\">print</span>(\r\n        <span class=\"hljs-string\">f&quot;Reversing Burrows Wheeler transform for entry &#x27;<span class=\"hljs-subst\">{result[<span class=\"hljs-string\">&#x27;bwt_string&#x27;</span>]}</span>&#x27; &quot;</span>\r\n        <span class=\"hljs-string\">f&quot;we get original string &#x27;<span class=\"hljs-subst\">{original_string}</span>&#x27;&quot;</span>\r\n    )\r\n"
    }
  },
  "contributors": [
    {
      "name": "Erwin Junge",
      "email": "erwin@junge.nl",
      "commits": 1
    },
    {
      "name": "CarsonHam",
      "email": "carson.ham@utexas.edu",
      "commits": 1
    },
    {
      "name": "William Zhang",
      "email": "39932068+WilliamHYZhang@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Bruno Simas Hadlich",
      "email": "brunosimashadlich@gmail.com",
      "commits": 1
    },
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 4
    }
  ],
  "explanationUrl": {}
}