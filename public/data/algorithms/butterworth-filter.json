{
  "slug": "butterworth-filter",
  "name": "Butterworth Filter",
  "categories": [
    "audiofilters"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "audio_filters\\butterworth_filter.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/audio_filters\\butterworth_filter.py",
      "code": "<span class=\"hljs-keyword\">from</span> math <span class=\"hljs-keyword\">import</span> cos, sin, sqrt, tau\r\n\r\n<span class=\"hljs-keyword\">from</span> audio_filters.iir_filter <span class=\"hljs-keyword\">import</span> IIRFilter\r\n\r\n<span class=\"hljs-string\">&quot;&quot;&quot;\r\nCreate 2nd-order IIR filters with Butterworth design.\r\n\r\nCode based on https://webaudio.github.io/Audio-EQ-Cookbook/audio-eq-cookbook.html\r\nAlternatively you can use scipy.signal.butter, which should yield the same results.\r\n&quot;&quot;&quot;</span>\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_lowpass</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a low-pass filter\r\n\r\n    &gt;&gt;&gt; filter = make_lowpass(1000, 48000)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [1.0922959556412573, -1.9828897227476208, 0.9077040443587427, 0.004277569313094809,\r\n     0.008555138626189618, 0.004277569313094809]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n\r\n    b0 = (<span class=\"hljs-number\">1</span> - _cos) / <span class=\"hljs-number\">2</span>\r\n    b1 = <span class=\"hljs-number\">1</span> - _cos\r\n\r\n    a0 = <span class=\"hljs-number\">1</span> + alpha\r\n    a1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    a2 = <span class=\"hljs-number\">1</span> - alpha\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b0])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_highpass</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a high-pass filter\r\n\r\n    &gt;&gt;&gt; filter = make_highpass(1000, 48000)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [1.0922959556412573, -1.9828897227476208, 0.9077040443587427, 0.9957224306869052,\r\n     -1.9914448613738105, 0.9957224306869052]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n\r\n    b0 = (<span class=\"hljs-number\">1</span> + _cos) / <span class=\"hljs-number\">2</span>\r\n    b1 = -<span class=\"hljs-number\">1</span> - _cos\r\n\r\n    a0 = <span class=\"hljs-number\">1</span> + alpha\r\n    a1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    a2 = <span class=\"hljs-number\">1</span> - alpha\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b0])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_bandpass</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a band-pass filter\r\n\r\n    &gt;&gt;&gt; filter = make_bandpass(1000, 48000)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [1.0922959556412573, -1.9828897227476208, 0.9077040443587427, 0.06526309611002579,\r\n     0, -0.06526309611002579]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n\r\n    b0 = _sin / <span class=\"hljs-number\">2</span>\r\n    b1 = <span class=\"hljs-number\">0</span>\r\n    b2 = -b0\r\n\r\n    a0 = <span class=\"hljs-number\">1</span> + alpha\r\n    a1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    a2 = <span class=\"hljs-number\">1</span> - alpha\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b2])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_allpass</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates an all-pass filter\r\n\r\n    &gt;&gt;&gt; filter = make_allpass(1000, 48000)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [1.0922959556412573, -1.9828897227476208, 0.9077040443587427, 0.9077040443587427,\r\n     -1.9828897227476208, 1.0922959556412573]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n\r\n    b0 = <span class=\"hljs-number\">1</span> - alpha\r\n    b1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    b2 = <span class=\"hljs-number\">1</span> + alpha\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([b2, b1, b0], [b0, b1, b2])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_peak</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, gain_db: <span class=\"hljs-built_in\">float</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a peak filter\r\n\r\n    &gt;&gt;&gt; filter = make_peak(1000, 48000, 6)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [1.0653405327119334, -1.9828897227476208, 0.9346594672880666, 1.1303715025601122,\r\n     -1.9828897227476208, 0.8696284974398878]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n    big_a = <span class=\"hljs-number\">10</span> ** (gain_db / <span class=\"hljs-number\">40</span>)\r\n\r\n    b0 = <span class=\"hljs-number\">1</span> + alpha * big_a\r\n    b1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    b2 = <span class=\"hljs-number\">1</span> - alpha * big_a\r\n    a0 = <span class=\"hljs-number\">1</span> + alpha / big_a\r\n    a1 = -<span class=\"hljs-number\">2</span> * _cos\r\n    a2 = <span class=\"hljs-number\">1</span> - alpha / big_a\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b2])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_lowshelf</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, gain_db: <span class=\"hljs-built_in\">float</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a low-shelf filter\r\n\r\n    &gt;&gt;&gt; filter = make_lowshelf(1000, 48000, 6)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [3.0409336710888786, -5.608870992220748, 2.602157875636628, 3.139954022810743,\r\n     -5.591841778072785, 2.5201667380627257]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n    big_a = <span class=\"hljs-number\">10</span> ** (gain_db / <span class=\"hljs-number\">40</span>)\r\n    pmc = (big_a + <span class=\"hljs-number\">1</span>) - (big_a - <span class=\"hljs-number\">1</span>) * _cos\r\n    ppmc = (big_a + <span class=\"hljs-number\">1</span>) + (big_a - <span class=\"hljs-number\">1</span>) * _cos\r\n    mpc = (big_a - <span class=\"hljs-number\">1</span>) - (big_a + <span class=\"hljs-number\">1</span>) * _cos\r\n    pmpc = (big_a - <span class=\"hljs-number\">1</span>) + (big_a + <span class=\"hljs-number\">1</span>) * _cos\r\n    aa2 = <span class=\"hljs-number\">2</span> * sqrt(big_a) * alpha\r\n\r\n    b0 = big_a * (pmc + aa2)\r\n    b1 = <span class=\"hljs-number\">2</span> * big_a * mpc\r\n    b2 = big_a * (pmc - aa2)\r\n    a0 = ppmc + aa2\r\n    a1 = -<span class=\"hljs-number\">2</span> * pmpc\r\n    a2 = ppmc - aa2\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b2])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">make_highshelf</span>(<span class=\"hljs-params\">\r\n    frequency: <span class=\"hljs-built_in\">int</span>, samplerate: <span class=\"hljs-built_in\">int</span>, gain_db: <span class=\"hljs-built_in\">float</span>, q_factor: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-number\">1</span> / sqrt(<span class=\"hljs-params\"><span class=\"hljs-number\">2</span></span>)\r\n</span>) -&gt; IIRFilter:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Creates a high-shelf filter\r\n\r\n    &gt;&gt;&gt; filter = make_highshelf(1000, 48000, 6)\r\n    &gt;&gt;&gt; filter.a_coeffs + filter.b_coeffs  # doctest: +NORMALIZE_WHITESPACE\r\n    [2.2229172136088806, -3.9587208137297303, 1.7841414181566304, 4.295432981120543,\r\n     -7.922740859457287, 3.6756456963725253]\r\n    &quot;&quot;&quot;</span>\r\n    w0 = tau * frequency / samplerate\r\n    _sin = sin(w0)\r\n    _cos = cos(w0)\r\n    alpha = _sin / (<span class=\"hljs-number\">2</span> * q_factor)\r\n    big_a = <span class=\"hljs-number\">10</span> ** (gain_db / <span class=\"hljs-number\">40</span>)\r\n    pmc = (big_a + <span class=\"hljs-number\">1</span>) - (big_a - <span class=\"hljs-number\">1</span>) * _cos\r\n    ppmc = (big_a + <span class=\"hljs-number\">1</span>) + (big_a - <span class=\"hljs-number\">1</span>) * _cos\r\n    mpc = (big_a - <span class=\"hljs-number\">1</span>) - (big_a + <span class=\"hljs-number\">1</span>) * _cos\r\n    pmpc = (big_a - <span class=\"hljs-number\">1</span>) + (big_a + <span class=\"hljs-number\">1</span>) * _cos\r\n    aa2 = <span class=\"hljs-number\">2</span> * sqrt(big_a) * alpha\r\n\r\n    b0 = big_a * (ppmc + aa2)\r\n    b1 = -<span class=\"hljs-number\">2</span> * big_a * pmpc\r\n    b2 = big_a * (ppmc - aa2)\r\n    a0 = pmc + aa2\r\n    a1 = <span class=\"hljs-number\">2</span> * mpc\r\n    a2 = pmc - aa2\r\n\r\n    filt = IIRFilter(<span class=\"hljs-number\">2</span>)\r\n    filt.set_coefficients([a0, a1, a2], [b0, b1, b2])\r\n    <span class=\"hljs-keyword\">return</span> filt\r\n"
    }
  },
  "contributors": [
    {
      "name": "Martmists",
      "email": "mail@martmists.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}