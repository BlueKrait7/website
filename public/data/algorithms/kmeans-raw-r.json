{
  "slug": "kmeans-raw-r",
  "name": "Kmeans Raw R",
  "categories": [
    "clusteringalgorithms"
  ],
  "body": {},
  "implementations": {
    "r": {
      "dir": "Clustering-Algorithms\\kmeans_raw_R.R",
      "url": "https://github.com/TheAlgorithms/r/tree/master/Clustering-Algorithms\\kmeans_raw_R.R",
      "code": "custonKmeans<span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-keyword\">function</span><span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-operator\">=</span><span class=\"hljs-literal\">NA</span><span class=\"hljs-punctuation\">,</span>k<span class=\"hljs-operator\">=</span><span class=\"hljs-literal\">NA</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n  <span class=\"hljs-keyword\">if</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-built_in\">is.na</span><span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">)</span> <span class=\"hljs-operator\">||</span> <span class=\"hljs-built_in\">is.na</span><span class=\"hljs-punctuation\">(</span>k<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n    stop<span class=\"hljs-punctuation\">(</span><span class=\"hljs-string\">&quot;You must input valid parameters!&quot;</span><span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n  Eudist<span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-keyword\">function</span><span class=\"hljs-punctuation\">(</span>x<span class=\"hljs-punctuation\">,</span>y<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n    distance<span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-built_in\">sqrt</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-built_in\">sum</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-punctuation\">(</span>x<span class=\"hljs-operator\">-</span>y<span class=\"hljs-punctuation\">)</span><span class=\"hljs-operator\">^</span><span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span>\r\n    <span class=\"hljs-built_in\">return</span> <span class=\"hljs-punctuation\">(</span>distance<span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n  \r\n  rows.dataset<span class=\"hljs-operator\">&lt;-</span>nrow<span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">)</span>\r\n  continue.change<span class=\"hljs-operator\">=</span><span class=\"hljs-literal\">TRUE</span>\r\n  initPoint<span class=\"hljs-operator\">&lt;-</span>dataset<span class=\"hljs-punctuation\">[</span>sample.int<span class=\"hljs-punctuation\">(</span>rows.dataset<span class=\"hljs-punctuation\">,</span>size <span class=\"hljs-operator\">=</span> k<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span>\r\n  formerPoint<span class=\"hljs-operator\">&lt;-</span>initPoint\r\n  iterPoint<span class=\"hljs-operator\">&lt;-</span>matrix<span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">0</span><span class=\"hljs-punctuation\">,</span>nrow <span class=\"hljs-operator\">=</span> k<span class=\"hljs-punctuation\">,</span>ncol <span class=\"hljs-operator\">=</span> ncol<span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span>\r\n  \r\n  <span class=\"hljs-comment\">#记录每一个点到每一个类的距离</span>\r\n  error.matrix<span class=\"hljs-operator\">&lt;-</span>matrix<span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">0</span><span class=\"hljs-punctuation\">,</span>nrow<span class=\"hljs-operator\">=</span>rows.dataset<span class=\"hljs-punctuation\">,</span>ncol<span class=\"hljs-operator\">=</span>k<span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-keyword\">while</span><span class=\"hljs-punctuation\">(</span>continue.change<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n    <span class=\"hljs-comment\">#记录每个点所属的类是哪一个</span>\r\n    cluster.matrix<span class=\"hljs-operator\">&lt;-</span>matrix<span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">0</span><span class=\"hljs-punctuation\">,</span>nrow<span class=\"hljs-operator\">=</span>rows.dataset<span class=\"hljs-punctuation\">,</span>ncol<span class=\"hljs-operator\">=</span>k<span class=\"hljs-punctuation\">)</span>\r\n    <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>rows.dataset<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span><span class=\"hljs-comment\">#计算每个点到三个初始中心点的距离</span>\r\n      <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>j <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>k<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n        error.matrix<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span>j<span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span>Eudist<span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>formerPoint<span class=\"hljs-punctuation\">[</span>j<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">)</span>\r\n      <span class=\"hljs-punctuation\">}</span>\r\n    <span class=\"hljs-punctuation\">}</span>\r\n    <span class=\"hljs-comment\">#将每一个点所属的类计算出来</span>\r\n    <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>rows.dataset<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n      cluster.matrix<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span>which.min<span class=\"hljs-punctuation\">(</span>error.matrix<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-number\">1</span>\r\n    <span class=\"hljs-punctuation\">}</span>\r\n    \r\n    <span class=\"hljs-comment\">#更新新的质心位置</span>\r\n    <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>k<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n      iterPoint<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span>apply<span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">[</span>which<span class=\"hljs-punctuation\">(</span>cluster.matrix<span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">,</span>i<span class=\"hljs-punctuation\">]</span> <span class=\"hljs-operator\">==</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-string\">&quot;mean&quot;</span><span class=\"hljs-punctuation\">)</span>\r\n    <span class=\"hljs-punctuation\">}</span>\r\n    all.true<span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-built_in\">c</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-punctuation\">)</span>\r\n    <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>k<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n      <span class=\"hljs-keyword\">if</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-built_in\">all</span><span class=\"hljs-punctuation\">(</span>formerPoint<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span> <span class=\"hljs-operator\">==</span> iterPoint<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">)</span> <span class=\"hljs-operator\">==</span> <span class=\"hljs-built_in\">T</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n        all.true<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-literal\">TRUE</span>\r\n      <span class=\"hljs-punctuation\">}</span>\r\n    <span class=\"hljs-punctuation\">}</span>\r\n    formerPoint <span class=\"hljs-operator\">=</span> iterPoint\r\n    continue.change<span class=\"hljs-operator\">=</span>ifelse<span class=\"hljs-punctuation\">(</span><span class=\"hljs-built_in\">all</span><span class=\"hljs-punctuation\">(</span>all.true<span class=\"hljs-punctuation\">)</span> <span class=\"hljs-operator\">==</span> <span class=\"hljs-built_in\">T</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-built_in\">F</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-built_in\">T</span><span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n  colnames<span class=\"hljs-punctuation\">(</span>iterPoint<span class=\"hljs-punctuation\">)</span><span class=\"hljs-operator\">&lt;-</span>colnames<span class=\"hljs-punctuation\">(</span>dataset<span class=\"hljs-punctuation\">)</span>\r\n  out<span class=\"hljs-operator\">=</span><span class=\"hljs-built_in\">list</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-punctuation\">)</span>\r\n  out<span class=\"hljs-punctuation\">[[</span><span class=\"hljs-string\">&quot;centers&quot;</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span>iterPoint\r\n  out<span class=\"hljs-punctuation\">[[</span><span class=\"hljs-string\">&quot;distance&quot;</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span>error.matrix\r\n  out<span class=\"hljs-punctuation\">[[</span><span class=\"hljs-string\">&quot;cluster&quot;</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span><span class=\"hljs-built_in\">rep</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">,</span>rows.dataset<span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-keyword\">for</span><span class=\"hljs-punctuation\">(</span>i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-number\">1</span><span class=\"hljs-operator\">:</span>rows.dataset<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">{</span>\r\n    out<span class=\"hljs-punctuation\">[[</span><span class=\"hljs-string\">&quot;cluster&quot;</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">]</span><span class=\"hljs-operator\">&lt;-</span>which<span class=\"hljs-punctuation\">(</span>cluster.matrix<span class=\"hljs-punctuation\">[</span>i<span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span> <span class=\"hljs-operator\">==</span> <span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">)</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n  <span class=\"hljs-built_in\">return</span><span class=\"hljs-punctuation\">(</span>out<span class=\"hljs-punctuation\">)</span>\r\n<span class=\"hljs-punctuation\">}</span>\r\n"
    }
  },
  "contributors": [
    {
      "name": "Ron Lee",
      "email": "857748998@qq.com",
      "commits": 1
    },
    {
      "name": "Erez Shomron",
      "email": "48328872+eshom@users.noreply.github.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}