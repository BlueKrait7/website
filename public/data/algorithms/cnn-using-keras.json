{
  "slug": "cnn-using-keras",
  "name": "CNN-Using Keras",
  "categories": [
    "neuralnetwork"
  ],
  "body": {
    "en": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "zh_Hans": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "ml": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "fr": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "de": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "eo": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "es": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "it": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "hr": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>",
    "uk": "<div class=\"nb-notebook\"><div class=\"nb-worksheet\"><div class=\"nb-cell nb-markdown-cell\"><h1 id=\"a-simple-convolutional-neural-network-using-keras\">A Simple Convolutional Neural Network (using Keras)</h1>\n<blockquote>\n<h2 id=\"explaining-the-code\">Explaining the code</h2>\n<blockquote>\n<h4 id=\"original-articles-\">Original Articles :</h4>\n</blockquote>\n</blockquote>\n<ul>\n<li><a href=\"https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/\">An Intuitive Guide to CNN</a></li>\n<li><a href=\"https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/\">CNN : How to Build one in Keras &amp; PyTorch</a></li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"import-the-required-libraries\">Import the required libraries:</h2>\n<ol>\n<li><p><strong>Numpy</strong>:\n<a href=\"https://numpy.org\">NumPy</a> is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.</p>\n</li>\n<li><p><strong>Keras</strong>:<a href=\"https://keras.io/\">Keras</a> is a high-level neural networks API, written in Python.</p>\n<ul>\n<li>Layers<ul>\n<li><strong>Activation</strong> : This is a method that applies an activation function to the output.</li>\n<li><strong>MaxPool2D</strong> : This method creates a Pooling layer to implement Max Pooling operation.</li>\n<li><strong>Conv2D</strong> : This method is used to create a convolution layer.</li>\n<li><strong>Flatten</strong> : This method flattens (converting into 1-Dimension) the input without affecting the batch size.</li>\n<li><strong>Dense</strong> : This method is used to create a fully connected neural network. </li>\n</ul>\n</li>\n<li>Models<ul>\n<li><strong>Sequential</strong>: The <a href=\"https://keras.io/getting-started/sequential-model-guide/\">Sequential model</a> is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the <strong>.add()</strong> method.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> keras.layers <span class=\"hljs-keyword\">import</span> Conv2D, Activation, MaxPool2D, Flatten, Dense\n<span class=\"hljs-keyword\">from</span> keras.models <span class=\"hljs-keyword\">import</span> Sequential</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"the-convolutional-neural-network-architecture\">The Convolutional Neural Network Architecture</h2>\n<p>A typical Convolutional Neural Network consists of the following parts:</p>\n<h3 id=\"1-the-hidden-layers-feature-extraction-part\">1. The Hidden Layers/ Feature Extraction Part</h3>\n<h4 id=\"the-covolution-and-pooling-layer\">(The Covolution and Pooling Layer)</h4>\n<p>In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.</p>\n<ul>\n<li>In the code snippet below, we initialise a <strong>Sequential model</strong>. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the <strong>.add()</strong> fuction as can be seen from the following snippets of code. </li>\n<li>This model lets us build a model by adding on one layer at a time.</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Images fed into this model are 28 x 28 pixels with 3 channels</span>\nimg_shape = (<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\n<span class=\"hljs-comment\"># Set up the model</span>\nmodel = Sequential()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><ul>\n<li>In the above line of codes,at first we define the <strong>img_shape</strong>.Here the <strong>img_shape</strong> denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.<strong>Therefore the first layer in a Sequential model needs to always receive information about the input shape.</strong></li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add convolutional layer with 3, 3 by 3 filters</span>\nmodel.add(Conv2D(<span class=\"hljs-number\">3</span>,kernel_size=<span class=\"hljs-number\">3</span>,input_shape=img_shape))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"conv2d\"><a href=\"https://keras.io/layers/convolutional/\">Conv2D()</a></h3>\n<p>This function creates a 2D Convolution Layer. </p>\n<h4 id=\"what-does-a-convolution-layer-do\">What does a Convolution Layer do?</h4>\n<ul>\n<li>A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)</li>\n<li>The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.</li>\n<li><strong>Parameters</strong> :<ul>\n<li>The first parameter (3 in this case), defines the number of neural nodes in each layer.</li>\n<li><strong>kernel_size</strong> defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.</li>\n<li><strong>input_shape</strong> is the pixel size of the images.</li>\n</ul>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"maxpool2d\"><a href=\"https://keras.io/layers/pooling/\">MaxPool2D()</a></h3>\n<p>This function creates a 2D Pooling Layer.</p>\n<h4 id=\"what-does-a-pooling-layer-do\">What does a Pooling Layer do?</h4>\n<ul>\n<li>Its function is to <strong>progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network</strong>, and hence to also <strong>control overfitting</strong>.</li>\n<li>The Pooling Layer <strong>operates independently on every depth slice of the input and resizes it spatially</strong>, using the MAX operation.</li>\n</ul>\n<h3 id=\"activation\">Activation()</h3>\n<p>The <strong>Activation()</strong> method is used to apply a specific activation function to the output of the Pooling layer.\nHere a <strong>relu</strong> activation function is added to the output layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># Add relu activation to the layer </span>\nmodel.add(Activation(<span class=\"hljs-string\">'relu'</span>))\n<span class=\"hljs-comment\">#Pooling</span>\nmodel.add(MaxPool2D(<span class=\"hljs-number\">2</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"2-classification-layer\">2. Classification Layer</h3>\n<p>After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\nThe thing about the fully connected layers is that it can only be fed <strong>1-Dimensional</strong> data. With the output data from the previous layer being <strong>3-Dimensional</strong> , it needs to the <strong>flatten out</strong>(converted into 1-Dimensional) before it can be fed into the Classification layer.</p>\n<p>For this a <strong>Flatten</strong> layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#Fully connected layers</span>\n<span class=\"hljs-comment\"># Use Flatten to convert 3D data to 1D</span>\nmodel.add(Flatten())\n<span class=\"hljs-comment\"># Add dense layer with 10 neurons</span>\nmodel.add(Dense(<span class=\"hljs-number\">10</span>))\n<span class=\"hljs-comment\"># we use the softmax activation function for our last layer</span>\nmodel.add(Activation(<span class=\"hljs-string\">'softmax'</span>))</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"dense\">Dense()</h3>\n<p>The final layer of the model is of type 'Dense', a densely-connected neural layer which will give the final classification/prediction.</p>\n<ul>\n<li>The parameter(in this case 10), refers to <strong>the number of output nodes.</strong></li>\n<li>After that a <strong>softmax</strong> activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.</li>\n</ul>\n</div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"summary\">Summary()</h3>\n<p>Now just to get an overview of the model we have created ,we will use the <strong>summary() function</strong>. This will list out the details regarding the Layer,the Output shape and the number of parameters.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\"># give an overview of our model</span>\nmodel.summary()</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"compilation\">Compilation:</h3>\n<p>Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: </p>\n<ul>\n<li><strong>An Optimiser</strong> : string identifier of an existing optimizer/a call to an optimizer function</li>\n<li><strong>A loss function</strong> : string identifier of an existing loss function/a call to a loss function</li>\n<li><strong>A list of metric</strong> : string identifier of an existing metric or a call to metric function<blockquote>\n<ul>\n<li>The metrics defines how the success of the model is evaluated.</li>\n<li>we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.</li>\n</ul>\n</blockquote>\n</li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.<span class=\"hljs-built_in\">compile</span>(loss=<span class=\"hljs-string\">'categorical_crossentropy'</span>, optimizer = <span class=\"hljs-string\">'adam'</span>, metrics=[<span class=\"hljs-string\">'accuracy'</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><p>Our model is complete.</p>\n<h3 id=\"the-training-phase\">The Training Phase:</h3>\n<p>Now we will train the model.</p>\n<blockquote>\n<p>We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-comment\">#importing the datasets</span>\n<span class=\"hljs-keyword\">from</span> keras.datasets <span class=\"hljs-keyword\">import</span> mnist\n<span class=\"hljs-comment\">#loading the datasets</span>\n(X_train, y_train), (X_test, y_test) = mnist.load_data()</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\nplt.imshow(X_train[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-built_in\">print</span>(X_train[<span class=\"hljs-number\">0</span>].shape)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h4 id=\"in-the-code-snippet-below-reshaping-is-done\">In the code snippet below, reshaping is done.</h4>\n<h2 id=\"but-why\">But WHY?</h2>\n<p><strong>Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.</strong></p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">X_train = X_train.reshape(<span class=\"hljs-number\">60000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)\nX_test = X_test.reshape(<span class=\"hljs-number\">10000</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">28</span>,<span class=\"hljs-number\">1</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"one-hot-encoding\">One-hot encoding:</h3>\n<p>In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.</p>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">from</span> keras.utils <span class=\"hljs-keyword\">import</span> to_categorical\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"fit-\"><a href=\"https://keras.io/models/sequential/\">fit( )</a></h3>\n<blockquote>\n<ul>\n<li>This method trains the model for a fixed number of epochs.</li>\n</ul>\n</blockquote>\n<ul>\n<li>An epoch is an iteration over the entire x and y data provided. </li>\n</ul>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=<span class=\"hljs-number\">10</span>, verbose=<span class=\"hljs-number\">2</span>)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h2 id=\"now-its-time-to-test-our-model\">Now its time to test our Model!!</h2>\n<p>We can test our model against a/some specific inputs with the help of the <strong>predict( )</strong> function as done in the code snippet below.</p>\n<blockquote>\n<ul>\n<li><strong>Output Format</strong>\n  The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.</li>\n</ul>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">model.predict(X_test[:<span class=\"hljs-number\">4</span>])</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"improving-the-displaying-of-the-results\">Improving the displaying of the results:</h3>\n<blockquote>\n<p>By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )</p>\n</blockquote>\n</div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\"><span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">return_Digit</span>(<span class=\"hljs-params\">x</span>):\n    a=np.where(x==<span class=\"hljs-built_in\">max</span>(x))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">int</span>(a[<span class=\"hljs-number\">0</span>]))</code></pre></div></div><div class=\"nb-cell nb-code-cell\"><div class=\"nb-input\"><pre class=\"\"><code class=\"lang-python hljs\" data-language=\"python\">prediction=model.predict(X_test[:<span class=\"hljs-number\">4</span>])\nnp.apply_along_axis(return_Digit,axis=<span class=\"hljs-number\">1</span>,arr=prediction)</code></pre></div></div><div class=\"nb-cell nb-markdown-cell\"><h3 id=\"---------------------------------------------------------------------------\">---------------------------------------------------------------------------</h3>\n</div></div></div>"
  },
  "implementations": {
    "jupyter": {
      "dir": "neural_network\\CNN-using keras.ipynb",
      "url": "https://github.com/TheAlgorithms/jupyter/tree/master/neural_network\\CNN-using keras.ipynb",
      "code": "<span class=\"hljs-punctuation\">{</span>\r\n <span class=\"hljs-attr\">&quot;cells&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;# A Simple Convolutional Neural Network (using Keras)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt;## Explaining the code \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt; &gt;#### Original Articles :  \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* [An Intuitive Guide to CNN](https://www.freecodecamp.org/news/an-intuitive-guide-to-convolutional-neural-networks-260c2de0a050/)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* [CNN : How to Build one in Keras &amp; PyTorch](https://missinglink.ai/guides/neural-network-concepts/convolutional-neural-network-build-one-keras-pytorch/)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;## Import the required libraries:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;1. **Numpy**:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;[NumPy](https://numpy.org) is a library for the Python programming language, adding support for large, multi-dimensional arrays and matrices, along with a large collection of high-level mathematical functions to operate on these arrays.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;1. **Keras**:[Keras](https://keras.io/) is a high-level neural networks API, written in Python.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;     * Layers\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **Activation** : This is a method that applies an activation function to the output.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **MaxPool2D** : This method creates a Pooling layer to implement Max Pooling operation.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **Conv2D** : This method is used to create a convolution layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **Flatten** : This method flattens (converting into 1-Dimension) the input without affecting the batch size.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **Dense** : This method is used to create a fully connected neural network. \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;     * Models\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;        * **Sequential**: The [Sequential model](https://keras.io/getting-started/sequential-model-guide/) is a linear stack of layers. We can create a Sequential model by passing a list of layer instances to the constructor or just by simply adding layers via the **.add()** method.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;import numpy as np\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;from keras.layers import Conv2D, Activation, MaxPool2D, Flatten, Dense\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;from keras.models import Sequential&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;## The Convolutional Neural Network Architecture\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;A typical Convolutional Neural Network consists of the following parts:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;### 1. The Hidden Layers/ Feature Extraction Part \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;#### (The Covolution and Pooling Layer)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;In this part of the network a series of convolution and pooling operations takes place, which are used for detecting different features of the input image.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* In the code snippet below, we initialise a **Sequential model**. At first we dont provide the constructor with the layers,but rather we go on adding the layers to the model by using the **.add()** fuction as can be seen from the following snippets of code. \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* This model lets us build a model by adding on one layer at a time.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;# Images fed into this model are 28 x 28 pixels with 3 channels\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;img_shape = (28,28,1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;# Set up the model\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model = Sequential()&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;* In the above line of codes,at first we define the **img_shape**.Here the **img_shape** denotes the input image shape to the model. It is important as the model needs to knpw what input shape it should expect to be fed.**Therefore the first layer in a Sequential model needs to always receive information about the input shape.**\\n&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;# Add convolutional layer with 3, 3 by 3 filters\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(Conv2D(3,kernel_size=3,input_shape=img_shape))&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### [Conv2D()](https://keras.io/layers/convolutional/)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;This function creates a 2D Convolution Layer. \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;####  What does a Convolution Layer do?\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* A convolution layer scans a source image with a filter to extract features which may be important for classification. (The filter is also called the convolution kernel.)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* The kernel also contains weights,which are tuned during the training of the model to achieve the most accurate predictions.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* **Parameters** :\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    * The first parameter (3 in this case), defines the number of neural nodes in each layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    * **kernel_size** defines the filter size—this is the area in square pixels the model will use to scan the image. Kernel size of 3 means the model looks at a square of 3×3 pixels at a time.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    * **input_shape** is the pixel size of the images.\\n&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### [MaxPool2D()](https://keras.io/layers/pooling/)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;This function creates a 2D Pooling Layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;#### What does a Pooling Layer do?\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* Its function is to **progressively reduce the spatial size of the representation to reduce the amount of parameters and computation in the network**, and hence to also **control overfitting**.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* The Pooling Layer **operates independently on every depth slice of the input and resizes it spatially**, using the MAX operation.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;### Activation()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;The **Activation()** method is used to apply a specific activation function to the output of the Pooling layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;Here a **relu** activation function is added to the output layer.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;# Add relu activation to the layer \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(Activation(&#x27;relu&#x27;))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;#Pooling\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(MaxPool2D(2))&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### 2. Classification Layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;After the convolution layer, there is classification layer that consists of fully connected layers, where neurons of one layer are connected with every activations from the previous layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;The thing about the fully connected layers is that it can only be fed **1-Dimensional** data. With the output data from the previous layer being **3-Dimensional** , it needs to the **flatten out**(converted into 1-Dimensional) before it can be fed into the Classification layer.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;For this a **Flatten** layer is added, which takes the output of the convolution layer and turns it into a format that can be used by the densely connected neural layer.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;#Fully connected layers\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;# Use Flatten to convert 3D data to 1D\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(Flatten())\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;# Add dense layer with 10 neurons\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(Dense(10))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;# we use the softmax activation function for our last layer\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.add(Activation(&#x27;softmax&#x27;))&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### Dense()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;The final layer of the model is of type &#x27;Dense&#x27;, a densely-connected neural layer which will give the final classification/prediction.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* The parameter(in this case 10), refers to **the number of output nodes.**\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* After that a **softmax** activation function is added to the output layer. It will take the output of the Dense layer and convert it into meaningful probabilities that will ultimately help in making the final prediction.\\n&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### Summary()\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;Now just to get an overview of the model we have created ,we will use the **summary() function**. This will list out the details regarding the Layer,the Output shape and the number of parameters.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;# give an overview of our model\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;model.summary()&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### Compilation:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;Before the training process, we have to put together a learning process in a particular form.This is done via compile(). It consists of 3 elements: \\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* **An Optimiser** : string identifier of an existing optimizer/a call to an optimizer function\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* **A loss function** : string identifier of an existing loss function/a call to a loss function\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* **A list of metric** : string identifier of an existing metric or a call to metric function\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot; &gt; * The metrics defines how the success of the model is evaluated.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot; &gt; * we will use the ‘accuracy’ metric to calculate an accuracy score on the testing/validation set of images.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;model.compile(loss=&#x27;categorical_crossentropy&#x27;, optimizer = &#x27;adam&#x27;, metrics=[&#x27;accuracy&#x27;])&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;Our model is complete.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;### The Training Phase:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;Now we will train the model.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt; We will use the MNIST dataset which is a benchmark deep learning dataset, containing 70,000 handwritten numbers from 0-9.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;#importing the datasets\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;from keras.datasets import mnist\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;#loading the datasets\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;(X_train, y_train), (X_test, y_test) = mnist.load_data()&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;import matplotlib.pyplot as plt\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;plt.imshow(X_train[0])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;print(X_train[0].shape)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;#### In the code snippet below, reshaping is done.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;## But WHY?\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;**Reshaping of the two sets of images, X_train and X_test is done so that their shape matches the shape expected by our CNN model.**&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;X_train = X_train.reshape(60000,28,28,1)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;X_test = X_test.reshape(10000,28,28,1)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### One-hot encoding:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;In one-hot encoding we create a column for each classification category, with each column containing binary values indicating if the current image belongs to that category or not.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;from keras.utils import to_categorical\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;y_train = to_categorical(y_train)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;y_test = to_categorical(y_test)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### [fit( )](https://keras.io/models/sequential/)\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt;* This method trains the model for a fixed number of epochs.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;* An epoch is an iteration over the entire x and y data provided. &quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;model.fit(X_train, y_train,validation_data=(X_test,y_test) ,epochs=10, verbose=2)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;## Now its time to test our Model!!\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;We can test our model against a/some specific inputs with the help of the **predict( )** function as done in the code snippet below.\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt; * **Output Format**\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    The output will consists of 10 probabilities, each representing the probability of being a particular digit from 0-9.&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;model.predict(X_test[:4])&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### Improving the displaying of the results:\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;&gt; By directly displaying the predicted number instead of the probabilities.(i.e. just refining the output. )&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;def return_Digit(x):\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    a=np.where(x==max(x))\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;    print(int(a[0]))&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;code&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;execution_count&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">null</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;outputs&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;prediction=model.predict(X_test[:4])\\n&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-string\">&quot;np.apply_along_axis(return_Digit,axis=1,arr=prediction)&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;cell_type&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;markdown&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span><span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;source&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span>\r\n    <span class=\"hljs-string\">&quot;### ---------------------------------------------------------------------------&quot;</span>\r\n   <span class=\"hljs-punctuation\">]</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n <span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span>\r\n <span class=\"hljs-attr\">&quot;metadata&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\r\n  <span class=\"hljs-attr\">&quot;kernelspec&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;display_name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;Python 3&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;language&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python3&quot;</span>\r\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n  <span class=\"hljs-attr\">&quot;language_info&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\r\n   <span class=\"hljs-attr\">&quot;codemirror_mode&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\r\n    <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n    <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">3</span>\r\n   <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;file_extension&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;.py&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;mimetype&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;text/x-python&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;nbconvert_exporter&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;python&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;pygments_lexer&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;ipython3&quot;</span><span class=\"hljs-punctuation\">,</span>\r\n   <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;3.7.4&quot;</span>\r\n  <span class=\"hljs-punctuation\">}</span>\r\n <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\r\n <span class=\"hljs-attr\">&quot;nbformat&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>\r\n <span class=\"hljs-attr\">&quot;nbformat_minor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">2</span>\r\n<span class=\"hljs-punctuation\">}</span>\r\n"
    }
  },
  "contributors": [
    {
      "name": "DeepankarAcharyya",
      "email": "deepankaracharyya@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}