{
  "slug": "burkes",
  "name": "Burkes",
  "categories": [
    "digitalimageprocessing",
    "dithering"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "digital_image_processing\\dithering\\burkes.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/digital_image_processing\\dithering\\burkes.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\r\nImplementation Burke&#x27;s algorithm (dithering)\r\n&quot;&quot;&quot;</span>\r\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\r\n<span class=\"hljs-keyword\">from</span> cv2 <span class=\"hljs-keyword\">import</span> destroyAllWindows, imread, imshow, waitKey\r\n\r\n\r\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Burkes</span>:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Burke&#x27;s algorithm is using for converting grayscale image to black and white version\r\n    Source: Source: https://en.wikipedia.org/wiki/Dither\r\n\r\n    Note:\r\n        * Best results are given with threshold= ~1/2 * max greyscale value.\r\n        * This implementation get RGB image and converts it to greyscale in runtime.\r\n    &quot;&quot;&quot;</span>\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, input_img, threshold: <span class=\"hljs-built_in\">int</span></span>):\r\n        self.min_threshold = <span class=\"hljs-number\">0</span>\r\n        <span class=\"hljs-comment\"># max greyscale value for #FFFFFF</span>\r\n        self.max_threshold = <span class=\"hljs-built_in\">int</span>(self.get_greyscale(<span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>))\r\n\r\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> self.min_threshold &lt; threshold &lt; self.max_threshold:\r\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">f&quot;Factor value should be from 0 to <span class=\"hljs-subst\">{self.max_threshold}</span>&quot;</span>)\r\n\r\n        self.input_img = input_img\r\n        self.threshold = threshold\r\n        self.width, self.height = self.input_img.shape[<span class=\"hljs-number\">1</span>], self.input_img.shape[<span class=\"hljs-number\">0</span>]\r\n\r\n        <span class=\"hljs-comment\"># error table size (+4 columns and +1 row) greater than input image because of</span>\r\n        <span class=\"hljs-comment\"># lack of if statements</span>\r\n        self.error_table = [\r\n            [<span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">for</span> _ <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(self.height + <span class=\"hljs-number\">4</span>)] <span class=\"hljs-keyword\">for</span> __ <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(self.width + <span class=\"hljs-number\">1</span>)\r\n        ]\r\n        self.output_img = np.ones((self.width, self.height, <span class=\"hljs-number\">3</span>), np.uint8) * <span class=\"hljs-number\">255</span>\r\n\r\n<span class=\"hljs-meta\">    @classmethod</span>\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_greyscale</span>(<span class=\"hljs-params\">cls, blue: <span class=\"hljs-built_in\">int</span>, green: <span class=\"hljs-built_in\">int</span>, red: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">float</span>:\r\n        <span class=\"hljs-string\">&quot;&quot;&quot;\r\n        &gt;&gt;&gt; Burkes.get_greyscale(3, 4, 5)\r\n        3.753\r\n        &quot;&quot;&quot;</span>\r\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0.114</span> * blue + <span class=\"hljs-number\">0.587</span> * green + <span class=\"hljs-number\">0.2126</span> * red\r\n\r\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-literal\">None</span>:\r\n        <span class=\"hljs-keyword\">for</span> y <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(self.height):\r\n            <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(self.width):\r\n                greyscale = <span class=\"hljs-built_in\">int</span>(self.get_greyscale(*self.input_img[y][x]))\r\n                <span class=\"hljs-keyword\">if</span> self.threshold &gt; greyscale + self.error_table[y][x]:\r\n                    self.output_img[y][x] = (<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>)\r\n                    current_error = greyscale + self.error_table[x][y]\r\n                <span class=\"hljs-keyword\">else</span>:\r\n                    self.output_img[y][x] = (<span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>, <span class=\"hljs-number\">255</span>)\r\n                    current_error = greyscale + self.error_table[x][y] - <span class=\"hljs-number\">255</span>\r\n                <span class=\"hljs-string\">&quot;&quot;&quot;\r\n                Burkes error propagation (`*` is current pixel):\r\n\r\n                                 *          8/32        4/32\r\n                2/32    4/32    8/32    4/32    2/32\r\n                &quot;&quot;&quot;</span>\r\n                self.error_table[y][x + <span class=\"hljs-number\">1</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">8</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y][x + <span class=\"hljs-number\">2</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">4</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y + <span class=\"hljs-number\">1</span>][x] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">8</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y + <span class=\"hljs-number\">1</span>][x + <span class=\"hljs-number\">1</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">4</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y + <span class=\"hljs-number\">1</span>][x + <span class=\"hljs-number\">2</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">2</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y + <span class=\"hljs-number\">1</span>][x - <span class=\"hljs-number\">1</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">4</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n                self.error_table[y + <span class=\"hljs-number\">1</span>][x - <span class=\"hljs-number\">2</span>] += <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-number\">2</span> / <span class=\"hljs-number\">32</span> * current_error)\r\n\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n    <span class=\"hljs-comment\"># create Burke&#x27;s instances with original images in greyscale</span>\r\n    burkes_instances = [\r\n        Burkes(imread(<span class=\"hljs-string\">&quot;image_data/lena.jpg&quot;</span>, <span class=\"hljs-number\">1</span>), threshold)\r\n        <span class=\"hljs-keyword\">for</span> threshold <span class=\"hljs-keyword\">in</span> (<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">126</span>, <span class=\"hljs-number\">130</span>, <span class=\"hljs-number\">140</span>)\r\n    ]\r\n\r\n    <span class=\"hljs-keyword\">for</span> burkes <span class=\"hljs-keyword\">in</span> burkes_instances:\r\n        burkes.process()\r\n\r\n    <span class=\"hljs-keyword\">for</span> burkes <span class=\"hljs-keyword\">in</span> burkes_instances:\r\n        imshow(\r\n            <span class=\"hljs-string\">f&quot;Original image with dithering threshold: <span class=\"hljs-subst\">{burkes.threshold}</span>&quot;</span>,\r\n            burkes.output_img,\r\n        )\r\n\r\n    waitKey(<span class=\"hljs-number\">0</span>)\r\n    destroyAllWindows()\r\n"
    }
  },
  "contributors": [
    {
      "name": "mateuszz0000",
      "email": "mtszzwdzk@gmail.com",
      "commits": 1
    },
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}