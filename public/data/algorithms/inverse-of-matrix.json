{
  "slug": "inverse-of-matrix",
  "name": "Inverse of Matrix",
  "categories": [
    "matrix"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "matrix\\inverse_of_matrix.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/matrix\\inverse_of_matrix.py",
      "code": "<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\r\n\r\n<span class=\"hljs-keyword\">from</span> decimal <span class=\"hljs-keyword\">import</span> Decimal\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">inverse_of_matrix</span>(<span class=\"hljs-params\">matrix: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">float</span>]]</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">float</span>]]:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    A matrix multiplied with its inverse gives the identity matrix.\r\n    This function finds the inverse of a 2x2 matrix.\r\n    If the determinant of a matrix is 0, its inverse does not exist.\r\n\r\n    Sources for fixing inaccurate float arithmetic:\r\n    https://stackoverflow.com/questions/6563058/how-do-i-use-accurate-float-arithmetic-in-python\r\n    https://docs.python.org/3/library/decimal.html\r\n\r\n    &gt;&gt;&gt; inverse_of_matrix([[2, 5], [2, 0]])\r\n    [[0.0, 0.5], [0.2, -0.2]]\r\n    &gt;&gt;&gt; inverse_of_matrix([[2.5, 5], [1, 2]])\r\n    Traceback (most recent call last):\r\n    ...\r\n    ValueError: This matrix has no inverse.\r\n    &gt;&gt;&gt; inverse_of_matrix([[12, -16], [-9, 0]])\r\n    [[0.0, -0.1111111111111111], [-0.0625, -0.08333333333333333]]\r\n    &gt;&gt;&gt; inverse_of_matrix([[12, 3], [16, 8]])\r\n    [[0.16666666666666666, -0.0625], [-0.3333333333333333, 0.25]]\r\n    &gt;&gt;&gt; inverse_of_matrix([[10, 5], [3, 2.5]])\r\n    [[0.25, -0.5], [-0.3, 1.0]]\r\n    &quot;&quot;&quot;</span>\r\n\r\n    D = Decimal  <span class=\"hljs-comment\"># An abbreviation to be conciseness</span>\r\n    <span class=\"hljs-comment\"># Calculate the determinant of the matrix</span>\r\n    determinant = D(matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>]) * D(matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">1</span>]) - D(matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">0</span>]) * D(matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">1</span>])\r\n    <span class=\"hljs-keyword\">if</span> determinant == <span class=\"hljs-number\">0</span>:\r\n        <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;This matrix has no inverse.&quot;</span>)\r\n    <span class=\"hljs-comment\"># Creates a copy of the matrix with swapped positions of the elements</span>\r\n    swapped_matrix = [[<span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">0.0</span>], [<span class=\"hljs-number\">0.0</span>, <span class=\"hljs-number\">0.0</span>]]\r\n    swapped_matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>], swapped_matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">1</span>] = matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">1</span>], matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>]\r\n    swapped_matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">0</span>], swapped_matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">1</span>] = -matrix[<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">0</span>], -matrix[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">1</span>]\r\n    <span class=\"hljs-comment\"># Calculate the inverse of the matrix</span>\r\n    <span class=\"hljs-keyword\">return</span> [[<span class=\"hljs-built_in\">float</span>(D(n) / determinant) <span class=\"hljs-keyword\">or</span> <span class=\"hljs-number\">0.0</span> <span class=\"hljs-keyword\">for</span> n <span class=\"hljs-keyword\">in</span> row] <span class=\"hljs-keyword\">for</span> row <span class=\"hljs-keyword\">in</span> swapped_matrix]\r\n"
    },
    "java": {
      "dir": "src\\main\\java\\com\\thealgorithms\\misc\\InverseOfMatrix.java",
      "url": "https://github.com/TheAlgorithms/java/tree/master/src\\main\\java\\com\\thealgorithms\\misc\\InverseOfMatrix.java",
      "code": "<span class=\"hljs-keyword\">package</span> com.thealgorithms.misc;\r\n\r\n<span class=\"hljs-keyword\">import</span> java.util.Scanner;\r\n\r\n<span class=\"hljs-comment\">/*\r\n* Wikipedia link : https://en.wikipedia.org/wiki/Invertible_matrix\r\n*\r\n* Here we use gauss elimination method to find the inverse of a given matrix.\r\n* To understand gauss elimination method to find inverse of a matrix: https://www.sangakoo.com/en/unit/inverse-matrix-method-of-gaussian-elimination\r\n*\r\n* We can also find the inverse of a matrix \r\n */</span>\r\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">InverseOfMatrix</span> {\r\n\r\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String argv[])</span> {\r\n        <span class=\"hljs-type\">Scanner</span> <span class=\"hljs-variable\">input</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Scanner</span>(System.in);\r\n        System.out.println(<span class=\"hljs-string\">&quot;Enter the matrix size (Square matrix only): &quot;</span>);\r\n        <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">n</span> <span class=\"hljs-operator\">=</span> input.nextInt();\r\n        <span class=\"hljs-type\">double</span> a[][] = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">double</span>[n][n];\r\n        System.out.println(<span class=\"hljs-string\">&quot;Enter the elements of matrix: &quot;</span>);\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; i++) {\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; j &lt; n; j++) {\r\n                a[i][j] = input.nextDouble();\r\n            }\r\n        }\r\n\r\n        <span class=\"hljs-type\">double</span> d[][] = invert(a);\r\n        System.out.println();\r\n        System.out.println(<span class=\"hljs-string\">&quot;The inverse is: &quot;</span>);\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; ++i) {\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; j &lt; n; ++j) {\r\n                System.out.print(d[i][j] + <span class=\"hljs-string\">&quot;  &quot;</span>);\r\n            }\r\n            System.out.println();\r\n        }\r\n        input.close();\r\n    }\r\n\r\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">double</span>[][] invert(<span class=\"hljs-type\">double</span> a[][]) {\r\n        <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">n</span> <span class=\"hljs-operator\">=</span> a.length;\r\n        <span class=\"hljs-type\">double</span> x[][] = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">double</span>[n][n];\r\n        <span class=\"hljs-type\">double</span> b[][] = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">double</span>[n][n];\r\n        <span class=\"hljs-type\">int</span> index[] = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">int</span>[n];\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; ++i) {\r\n            b[i][i] = <span class=\"hljs-number\">1</span>;\r\n        }\r\n\r\n        <span class=\"hljs-comment\">// Transform the matrix into an upper triangle</span>\r\n        gaussian(a, index);\r\n\r\n        <span class=\"hljs-comment\">// Update the matrix b[i][j] with the ratios stored</span>\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n - <span class=\"hljs-number\">1</span>; ++i) {\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> i + <span class=\"hljs-number\">1</span>; j &lt; n; ++j) {\r\n                <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">k</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; k &lt; n; ++k) {\r\n                    b[index[j]][k]\r\n                            -= a[index[j]][i] * b[index[i]][k];\r\n                }\r\n            }\r\n        }\r\n\r\n        <span class=\"hljs-comment\">// Perform backward substitutions</span>\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; ++i) {\r\n            x[n - <span class=\"hljs-number\">1</span>][i] = b[index[n - <span class=\"hljs-number\">1</span>]][i] / a[index[n - <span class=\"hljs-number\">1</span>]][n - <span class=\"hljs-number\">1</span>];\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> n - <span class=\"hljs-number\">2</span>; j &gt;= <span class=\"hljs-number\">0</span>; --j) {\r\n                x[j][i] = b[index[j]][i];\r\n                <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">k</span> <span class=\"hljs-operator\">=</span> j + <span class=\"hljs-number\">1</span>; k &lt; n; ++k) {\r\n                    x[j][i] -= a[index[j]][k] * x[k][i];\r\n                }\r\n                x[j][i] /= a[index[j]][j];\r\n            }\r\n        }\r\n        <span class=\"hljs-keyword\">return</span> x;\r\n    }\r\n\r\n<span class=\"hljs-comment\">// Method to carry out the partial-pivoting Gaussian</span>\r\n<span class=\"hljs-comment\">// elimination.  Here index[] stores pivoting order.</span>\r\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">gaussian</span><span class=\"hljs-params\">(<span class=\"hljs-type\">double</span> a[][], <span class=\"hljs-type\">int</span> index[])</span> {\r\n        <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">n</span> <span class=\"hljs-operator\">=</span> index.length;\r\n        <span class=\"hljs-type\">double</span> c[] = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">double</span>[n];\r\n\r\n        <span class=\"hljs-comment\">// Initialize the index</span>\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; ++i) {\r\n            index[i] = i;\r\n        }\r\n\r\n        <span class=\"hljs-comment\">// Find the rescaling factors, one from each row</span>\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; n; ++i) {\r\n            <span class=\"hljs-type\">double</span> <span class=\"hljs-variable\">c1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>;\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; j &lt; n; ++j) {\r\n                <span class=\"hljs-type\">double</span> <span class=\"hljs-variable\">c0</span> <span class=\"hljs-operator\">=</span> Math.abs(a[i][j]);\r\n                <span class=\"hljs-keyword\">if</span> (c0 &gt; c1) {\r\n                    c1 = c0;\r\n                }\r\n            }\r\n            c[i] = c1;\r\n        }\r\n\r\n        <span class=\"hljs-comment\">// Search the pivoting element from each column</span>\r\n        <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">k</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>;\r\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; j &lt; n - <span class=\"hljs-number\">1</span>; ++j) {\r\n            <span class=\"hljs-type\">double</span> <span class=\"hljs-variable\">pi1</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>;\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> j; i &lt; n; ++i) {\r\n                <span class=\"hljs-type\">double</span> <span class=\"hljs-variable\">pi0</span> <span class=\"hljs-operator\">=</span> Math.abs(a[index[i]][j]);\r\n                pi0 /= c[index[i]];\r\n                <span class=\"hljs-keyword\">if</span> (pi0 &gt; pi1) {\r\n                    pi1 = pi0;\r\n                    k = i;\r\n                }\r\n            }\r\n            <span class=\"hljs-comment\">// Interchange rows according to the pivoting order</span>\r\n            <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">itmp</span> <span class=\"hljs-operator\">=</span> index[j];\r\n            index[j] = index[k];\r\n            index[k] = itmp;\r\n            <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> j + <span class=\"hljs-number\">1</span>; i &lt; n; ++i) {\r\n                <span class=\"hljs-type\">double</span> <span class=\"hljs-variable\">pj</span> <span class=\"hljs-operator\">=</span> a[index[i]][j] / a[index[j]][j];\r\n\r\n                <span class=\"hljs-comment\">// Record pivoting ratios below the diagonal</span>\r\n                a[index[i]][j] = pj;\r\n\r\n                <span class=\"hljs-comment\">// Modify other elements accordingly</span>\r\n                <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">l</span> <span class=\"hljs-operator\">=</span> j + <span class=\"hljs-number\">1</span>; l &lt; n; ++l) {\r\n                    a[index[i]][l] -= pj * a[index[j]][l];\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 1
    },
    {
      "name": "Aitor Fidalgo Sánchez",
      "email": "64830228+aitorfi@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "RobotGuy999",
      "email": "68413067+RobotGuy999@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}