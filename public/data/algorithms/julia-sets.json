{
  "slug": "julia-sets",
  "name": "Julia Sets",
  "categories": [
    "fractals"
  ],
  "body": {},
  "implementations": {
    "python": {
      "dir": "fractals\\julia_sets.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/fractals\\julia_sets.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;Author Alexandre De Zotti\r\n\r\nDraws Julia sets of quadratic polynomials and exponential maps.\r\n More specifically, this iterates the function a fixed number of times\r\n then plots whether the absolute value of the last iterate is greater than\r\n a fixed threshold (named &quot;escape radius&quot;). For the exponential map this is not\r\n really an escape radius but rather a convenient way to approximate the Julia\r\n set with bounded orbits.\r\n\r\nThe examples presented here are:\r\n- The Cauliflower Julia set, see e.g.\r\nhttps://en.wikipedia.org/wiki/File:Julia_z2%2B0,25.png\r\n- Other examples from https://en.wikipedia.org/wiki/Julia_set\r\n- An exponential map Julia set, ambiantly homeomorphic to the examples in\r\nhttp://www.math.univ-toulouse.fr/~cheritat/GalII/galery.html\r\n and\r\nhttps://ddd.uab.cat/pub/pubmat/02141493v43n1/02141493v43n1p27.pdf\r\n\r\nRemark: Some overflow runtime warnings are suppressed. This is because of the\r\n way the iteration loop is implemented, using numpy&#x27;s efficient computations.\r\n Overflows and infinites are replaced after each step by a large number.\r\n&quot;&quot;&quot;</span>\r\n\r\n<span class=\"hljs-keyword\">import</span> warnings\r\n<span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> <span class=\"hljs-type\">Any</span>, <span class=\"hljs-type\">Callable</span>\r\n\r\n<span class=\"hljs-keyword\">import</span> numpy\r\n<span class=\"hljs-keyword\">from</span> matplotlib <span class=\"hljs-keyword\">import</span> pyplot\r\n\r\nc_cauliflower = <span class=\"hljs-number\">0.25</span> + <span class=\"hljs-number\">0.0j</span>\r\nc_polynomial_1 = -<span class=\"hljs-number\">0.4</span> + <span class=\"hljs-number\">0.6j</span>\r\nc_polynomial_2 = -<span class=\"hljs-number\">0.1</span> + <span class=\"hljs-number\">0.651j</span>\r\nc_exponential = -<span class=\"hljs-number\">2.0</span>\r\nnb_iterations = <span class=\"hljs-number\">56</span>\r\nwindow_size = <span class=\"hljs-number\">2.0</span>\r\nnb_pixels = <span class=\"hljs-number\">666</span>\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">eval_exponential</span>(<span class=\"hljs-params\">c_parameter: <span class=\"hljs-built_in\">complex</span>, z_values: numpy.ndarray</span>) -&gt; numpy.ndarray:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Evaluate $e^z + c$.\r\n    &gt;&gt;&gt; eval_exponential(0, 0)\r\n    1.0\r\n    &gt;&gt;&gt; abs(eval_exponential(1, numpy.pi*1.j)) &lt; 1e-15\r\n    True\r\n    &gt;&gt;&gt; abs(eval_exponential(1.j, 0)-1-1.j) &lt; 1e-15\r\n    True\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">return</span> numpy.exp(z_values) + c_parameter\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">eval_quadratic_polynomial</span>(<span class=\"hljs-params\">\r\n    c_parameter: <span class=\"hljs-built_in\">complex</span>, z_values: numpy.ndarray\r\n</span>) -&gt; numpy.ndarray:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    &gt;&gt;&gt; eval_quadratic_polynomial(0, 2)\r\n    4\r\n    &gt;&gt;&gt; eval_quadratic_polynomial(-1, 1)\r\n    0\r\n    &gt;&gt;&gt; round(eval_quadratic_polynomial(1.j, 0).imag)\r\n    1\r\n    &gt;&gt;&gt; round(eval_quadratic_polynomial(1.j, 0).real)\r\n    0\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">return</span> z_values * z_values + c_parameter\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">prepare_grid</span>(<span class=\"hljs-params\">window_size: <span class=\"hljs-built_in\">float</span>, nb_pixels: <span class=\"hljs-built_in\">int</span></span>) -&gt; numpy.ndarray:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Create a grid of complex values of size nb_pixels*nb_pixels with real and\r\n     imaginary parts ranging from -window_size to window_size (inclusive).\r\n    Returns a numpy array.\r\n\r\n    &gt;&gt;&gt; prepare_grid(1,3)\r\n    array([[-1.-1.j, -1.+0.j, -1.+1.j],\r\n           [ 0.-1.j,  0.+0.j,  0.+1.j],\r\n           [ 1.-1.j,  1.+0.j,  1.+1.j]])\r\n    &quot;&quot;&quot;</span>\r\n    x = numpy.linspace(-window_size, window_size, nb_pixels)\r\n    x = x.reshape((nb_pixels, <span class=\"hljs-number\">1</span>))\r\n    y = numpy.linspace(-window_size, window_size, nb_pixels)\r\n    y = y.reshape((<span class=\"hljs-number\">1</span>, nb_pixels))\r\n    <span class=\"hljs-keyword\">return</span> x + <span class=\"hljs-number\">1.0j</span> * y\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">iterate_function</span>(<span class=\"hljs-params\">\r\n    eval_function: <span class=\"hljs-type\">Callable</span>[[<span class=\"hljs-type\">Any</span>, numpy.ndarray], numpy.ndarray],\r\n    function_params: <span class=\"hljs-type\">Any</span>,\r\n    nb_iterations: <span class=\"hljs-built_in\">int</span>,\r\n    z_0: numpy.ndarray,\r\n    infinity: <span class=\"hljs-built_in\">float</span> = <span class=\"hljs-literal\">None</span>,\r\n</span>) -&gt; numpy.ndarray:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Iterate the function &quot;eval_function&quot; exactly nb_iterations times.\r\n    The first argument of the function is a parameter which is contained in\r\n    function_params. The variable z_0 is an array that contains the initial\r\n    values to iterate from.\r\n    This function returns the final iterates.\r\n\r\n    &gt;&gt;&gt; iterate_function(eval_quadratic_polynomial, 0, 3, numpy.array([0,1,2])).shape\r\n    (3,)\r\n    &gt;&gt;&gt; numpy.round(iterate_function(eval_quadratic_polynomial,\r\n    ... 0,\r\n    ... 3,\r\n    ... numpy.array([0,1,2]))[0])\r\n    0j\r\n    &gt;&gt;&gt; numpy.round(iterate_function(eval_quadratic_polynomial,\r\n    ... 0,\r\n    ... 3,\r\n    ... numpy.array([0,1,2]))[1])\r\n    (1+0j)\r\n    &gt;&gt;&gt; numpy.round(iterate_function(eval_quadratic_polynomial,\r\n    ... 0,\r\n    ... 3,\r\n    ... numpy.array([0,1,2]))[2])\r\n    (256+0j)\r\n    &quot;&quot;&quot;</span>\r\n\r\n    z_n = z_0.astype(<span class=\"hljs-string\">&quot;complex64&quot;</span>)\r\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(nb_iterations):\r\n        z_n = eval_function(function_params, z_n)\r\n        <span class=\"hljs-keyword\">if</span> infinity <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-literal\">None</span>:\r\n            numpy.nan_to_num(z_n, copy=<span class=\"hljs-literal\">False</span>, nan=infinity)\r\n            z_n[<span class=\"hljs-built_in\">abs</span>(z_n) == numpy.inf] = infinity\r\n    <span class=\"hljs-keyword\">return</span> z_n\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">show_results</span>(<span class=\"hljs-params\">\r\n    function_label: <span class=\"hljs-built_in\">str</span>,\r\n    function_params: <span class=\"hljs-type\">Any</span>,\r\n    escape_radius: <span class=\"hljs-built_in\">float</span>,\r\n    z_final: numpy.ndarray,\r\n</span>) -&gt; <span class=\"hljs-literal\">None</span>:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Plots of whether the absolute value of z_final is greater than\r\n    the value of escape_radius. Adds the function_label and function_params to\r\n    the title.\r\n\r\n    &gt;&gt;&gt; show_results(&#x27;80&#x27;, 0, 1, numpy.array([[0,1,.5],[.4,2,1.1],[.2,1,1.3]]))\r\n    &quot;&quot;&quot;</span>\r\n\r\n    abs_z_final = (<span class=\"hljs-built_in\">abs</span>(z_final)).transpose()\r\n    abs_z_final[:, :] = abs_z_final[::-<span class=\"hljs-number\">1</span>, :]\r\n    pyplot.matshow(abs_z_final &lt; escape_radius)\r\n    pyplot.title(<span class=\"hljs-string\">f&quot;Julia set of $<span class=\"hljs-subst\">{function_label}</span>$, $c=<span class=\"hljs-subst\">{function_params}</span>$&quot;</span>)\r\n    pyplot.show()\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">ignore_overflow_warnings</span>() -&gt; <span class=\"hljs-literal\">None</span>:\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    Ignore some overflow and invalid value warnings.\r\n\r\n    &gt;&gt;&gt; ignore_overflow_warnings()\r\n    &quot;&quot;&quot;</span>\r\n    warnings.filterwarnings(\r\n        <span class=\"hljs-string\">&quot;ignore&quot;</span>, category=RuntimeWarning, message=<span class=\"hljs-string\">&quot;overflow encountered in multiply&quot;</span>\r\n    )\r\n    warnings.filterwarnings(\r\n        <span class=\"hljs-string\">&quot;ignore&quot;</span>,\r\n        category=RuntimeWarning,\r\n        message=<span class=\"hljs-string\">&quot;invalid value encountered in multiply&quot;</span>,\r\n    )\r\n    warnings.filterwarnings(\r\n        <span class=\"hljs-string\">&quot;ignore&quot;</span>, category=RuntimeWarning, message=<span class=\"hljs-string\">&quot;overflow encountered in absolute&quot;</span>\r\n    )\r\n    warnings.filterwarnings(\r\n        <span class=\"hljs-string\">&quot;ignore&quot;</span>, category=RuntimeWarning, message=<span class=\"hljs-string\">&quot;overflow encountered in exp&quot;</span>\r\n    )\r\n\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n\r\n    z_0 = prepare_grid(window_size, nb_pixels)\r\n\r\n    ignore_overflow_warnings()  <span class=\"hljs-comment\"># See file header for explanations</span>\r\n\r\n    nb_iterations = <span class=\"hljs-number\">24</span>\r\n    escape_radius = <span class=\"hljs-number\">2</span> * <span class=\"hljs-built_in\">abs</span>(c_cauliflower) + <span class=\"hljs-number\">1</span>\r\n    z_final = iterate_function(\r\n        eval_quadratic_polynomial,\r\n        c_cauliflower,\r\n        nb_iterations,\r\n        z_0,\r\n        infinity=<span class=\"hljs-number\">1.1</span> * escape_radius,\r\n    )\r\n    show_results(<span class=\"hljs-string\">&quot;z^2+c&quot;</span>, c_cauliflower, escape_radius, z_final)\r\n\r\n    nb_iterations = <span class=\"hljs-number\">64</span>\r\n    escape_radius = <span class=\"hljs-number\">2</span> * <span class=\"hljs-built_in\">abs</span>(c_polynomial_1) + <span class=\"hljs-number\">1</span>\r\n    z_final = iterate_function(\r\n        eval_quadratic_polynomial,\r\n        c_polynomial_1,\r\n        nb_iterations,\r\n        z_0,\r\n        infinity=<span class=\"hljs-number\">1.1</span> * escape_radius,\r\n    )\r\n    show_results(<span class=\"hljs-string\">&quot;z^2+c&quot;</span>, c_polynomial_1, escape_radius, z_final)\r\n\r\n    nb_iterations = <span class=\"hljs-number\">161</span>\r\n    escape_radius = <span class=\"hljs-number\">2</span> * <span class=\"hljs-built_in\">abs</span>(c_polynomial_2) + <span class=\"hljs-number\">1</span>\r\n    z_final = iterate_function(\r\n        eval_quadratic_polynomial,\r\n        c_polynomial_2,\r\n        nb_iterations,\r\n        z_0,\r\n        infinity=<span class=\"hljs-number\">1.1</span> * escape_radius,\r\n    )\r\n    show_results(<span class=\"hljs-string\">&quot;z^2+c&quot;</span>, c_polynomial_2, escape_radius, z_final)\r\n\r\n    nb_iterations = <span class=\"hljs-number\">12</span>\r\n    escape_radius = <span class=\"hljs-number\">10000.0</span>\r\n    z_final = iterate_function(\r\n        eval_exponential,\r\n        c_exponential,\r\n        nb_iterations,\r\n        z_0 + <span class=\"hljs-number\">2</span>,\r\n        infinity=<span class=\"hljs-number\">1.0e10</span>,\r\n    )\r\n    show_results(<span class=\"hljs-string\">&quot;e^z+c&quot;</span>, c_exponential, escape_radius, z_final)\r\n"
    }
  },
  "contributors": [
    {
      "name": "Alexandre De Zotti",
      "email": "alexn11@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}