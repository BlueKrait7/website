{
  "slug": "genetic",
  "name": "Genetic",
  "categories": [
    "strings"
  ],
  "body": {},
  "implementations": {
    "go": {
      "dir": "strings\\genetic\\genetic.go",
      "url": "https://github.com/TheAlgorithms/go/tree/master/strings\\genetic\\genetic.go",
      "code": "<span class=\"hljs-comment\">// Package genetic provides functions to work with strings</span>\r\n<span class=\"hljs-comment\">// using genetic algorithm. https://en.wikipedia.org/wiki/Genetic_algorithm</span>\r\n<span class=\"hljs-comment\">//</span>\r\n<span class=\"hljs-comment\">// Author: D4rkia</span>\r\n<span class=\"hljs-keyword\">package</span> genetic\r\n\r\n<span class=\"hljs-keyword\">import</span> (\r\n\t<span class=\"hljs-string\">&quot;errors&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;fmt&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;math/rand&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;sort&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;strconv&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;time&quot;</span>\r\n\t<span class=\"hljs-string\">&quot;unicode/utf8&quot;</span>\r\n)\r\n\r\n<span class=\"hljs-comment\">// Population item represent a single step in the evolution process.</span>\r\n<span class=\"hljs-comment\">// One can think of population item as a single species.</span>\r\n<span class=\"hljs-comment\">// Key stands for the actual data entity of the species, which is a string</span>\r\n<span class=\"hljs-comment\">// in current implementation. Key can be interpreted as species DNA.</span>\r\n<span class=\"hljs-comment\">// Value shows how close this species to the desired target, where 1 means,</span>\r\n<span class=\"hljs-comment\">// that species DNA equals to the targeted one, 0 for no matchings in the DNA.</span>\r\n<span class=\"hljs-comment\">//</span>\r\n<span class=\"hljs-comment\">// **Note** In the current implementation species DNA length is suppose to be</span>\r\n<span class=\"hljs-comment\">// equal to the target length for algorithm to work.</span>\r\n<span class=\"hljs-keyword\">type</span> PopulationItem <span class=\"hljs-keyword\">struct</span> {\r\n\tKey   <span class=\"hljs-type\">string</span>\r\n\tValue <span class=\"hljs-type\">float64</span>\r\n}\r\n\r\n<span class=\"hljs-comment\">// Conf stands for cofigurations set provided to GeneticString function.</span>\r\n<span class=\"hljs-keyword\">type</span> Conf <span class=\"hljs-keyword\">struct</span> {\r\n\t<span class=\"hljs-comment\">// Maximum size of the population.</span>\r\n\t<span class=\"hljs-comment\">// Bigger could be faster but more memory expensive.</span>\r\n\tPopulationNum <span class=\"hljs-type\">int</span>\r\n\r\n\t<span class=\"hljs-comment\">// Number of elements selected in every generation for evolution</span>\r\n\t<span class=\"hljs-comment\">// the selection takes. Place from the best to the worst of that</span>\r\n\t<span class=\"hljs-comment\">// generation must be smaller than PopulationNum.</span>\r\n\tSelectionNum <span class=\"hljs-type\">int</span>\r\n\r\n\t<span class=\"hljs-comment\">// Probability that an element of a generation can mutate changing one of</span>\r\n\t<span class=\"hljs-comment\">// its genes this guarantees that all genes will be used during evolution.</span>\r\n\tMutationProb <span class=\"hljs-type\">float64</span>\r\n\r\n\t<span class=\"hljs-comment\">// Enables debugging output to the console.</span>\r\n\tDebug <span class=\"hljs-type\">bool</span>\r\n}\r\n\r\n<span class=\"hljs-comment\">// Result structure contains generation process statistics, as well as the</span>\r\n<span class=\"hljs-comment\">// best resulted population item.</span>\r\n<span class=\"hljs-keyword\">type</span> Result <span class=\"hljs-keyword\">struct</span> {\r\n\t<span class=\"hljs-comment\">// Number of generations steps performed.</span>\r\n\tGeneration <span class=\"hljs-type\">int</span>\r\n\r\n\t<span class=\"hljs-comment\">// Number of generated population items.</span>\r\n\tAnalyzed <span class=\"hljs-type\">int</span>\r\n\r\n\t<span class=\"hljs-comment\">// Result of generation with the best Value.</span>\r\n\tBest PopulationItem\r\n}\r\n\r\n<span class=\"hljs-comment\">// GeneticString generates PopultaionItem based on the imputed target</span>\r\n<span class=\"hljs-comment\">// string, and a set of possible runes to build a string with. In order</span>\r\n<span class=\"hljs-comment\">// to optimise string generation additional configurations can be provided</span>\r\n<span class=\"hljs-comment\">// with Conf instance. Empty instance of Conf (&amp;Conf{}) can be provided,</span>\r\n<span class=\"hljs-comment\">// then default values would be set.</span>\r\n<span class=\"hljs-comment\">//</span>\r\n<span class=\"hljs-comment\">// Link to the same algorithm implemented in python:</span>\r\n<span class=\"hljs-comment\">// https://github.com/TheAlgorithms/Python/blob/master/genetic_algorithm/basic_string.py</span>\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">func</span> <span class=\"hljs-title\">GeneticString</span><span class=\"hljs-params\">(target <span class=\"hljs-type\">string</span>, charmap []<span class=\"hljs-type\">rune</span>, conf *Conf)</span></span> (*Result, <span class=\"hljs-type\">error</span>) {\r\n\tpopulationNum := conf.PopulationNum\r\n\t<span class=\"hljs-keyword\">if</span> populationNum == <span class=\"hljs-number\">0</span> {\r\n\t\tpopulationNum = <span class=\"hljs-number\">200</span>\r\n\t}\r\n\r\n\tselectionNum := conf.SelectionNum\r\n\t<span class=\"hljs-keyword\">if</span> selectionNum == <span class=\"hljs-number\">0</span> {\r\n\t\tselectionNum = <span class=\"hljs-number\">50</span>\r\n\t}\r\n\r\n\t<span class=\"hljs-comment\">// Verify if &#x27;populationNum&#x27; s bigger than &#x27;selectionNum&#x27;</span>\r\n\t<span class=\"hljs-keyword\">if</span> populationNum &lt; selectionNum {\r\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">nil</span>, errors.New(<span class=\"hljs-string\">&quot;populationNum must be bigger than selectionNum&quot;</span>)\r\n\t}\r\n\r\n\tmutationProb := conf.MutationProb\r\n\t<span class=\"hljs-keyword\">if</span> mutationProb == <span class=\"hljs-number\">.0</span> {\r\n\t\tmutationProb = <span class=\"hljs-number\">.4</span>\r\n\t}\r\n\r\n\tdebug := conf.Debug\r\n\r\n\t<span class=\"hljs-comment\">// Just a seed to improve randomness required by the algorithm</span>\r\n\trand.Seed(time.Now().UnixNano())\r\n\r\n\t<span class=\"hljs-comment\">// Verify that the target contains no genes besides the ones inside genes variable.</span>\r\n\t<span class=\"hljs-keyword\">for</span> position, r := <span class=\"hljs-keyword\">range</span> target {\r\n\t\tinvalid := <span class=\"hljs-literal\">true</span>\r\n\t\t<span class=\"hljs-keyword\">for</span> _, n := <span class=\"hljs-keyword\">range</span> charmap {\r\n\t\t\t<span class=\"hljs-keyword\">if</span> n == r {\r\n\t\t\t\tinvalid = <span class=\"hljs-literal\">false</span>\r\n\t\t\t}\r\n\t\t}\r\n\t\t<span class=\"hljs-keyword\">if</span> invalid {\r\n\t\t\tmessage := fmt.Sprintf(<span class=\"hljs-string\">&quot;character not available in charmap at position: %v&quot;</span>, position)\r\n\t\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">nil</span>, errors.New(message)\r\n\t\t}\r\n\t}\r\n\r\n\t<span class=\"hljs-comment\">// Generate random starting population</span>\r\n\tpop := <span class=\"hljs-built_in\">make</span>([]PopulationItem, populationNum)\r\n\t<span class=\"hljs-keyword\">for</span> i := <span class=\"hljs-number\">0</span>; i &lt; populationNum; i++ {\r\n\t\tkey := <span class=\"hljs-string\">&quot;&quot;</span>\r\n\t\t<span class=\"hljs-keyword\">for</span> x := <span class=\"hljs-number\">0</span>; x &lt; utf8.RuneCountInString(target); x++ {\r\n\t\t\tchoice := rand.Intn(<span class=\"hljs-built_in\">len</span>(charmap))\r\n\t\t\tkey += <span class=\"hljs-type\">string</span>(charmap[choice])\r\n\t\t}\r\n\t\tpop[i] = PopulationItem{key, <span class=\"hljs-number\">0</span>}\r\n\t}\r\n\r\n\t<span class=\"hljs-comment\">// Just some logs to know what the algorithms is doing</span>\r\n\tgen, generatedPop := <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>\r\n\r\n\t<span class=\"hljs-comment\">// This loop will end when we will find a perfect match for our target</span>\r\n\t<span class=\"hljs-keyword\">for</span> {\r\n\t\tgen++\r\n\t\tgeneratedPop += <span class=\"hljs-built_in\">len</span>(pop)\r\n\r\n\t\t<span class=\"hljs-comment\">// Random population created now it&#x27;s time to evaluate</span>\r\n\t\t<span class=\"hljs-keyword\">for</span> i, item := <span class=\"hljs-keyword\">range</span> pop {\r\n\t\t\tpop[i].Value = <span class=\"hljs-number\">0</span>\r\n\t\t\titemKey, targetRune := []<span class=\"hljs-type\">rune</span>(item.Key), []<span class=\"hljs-type\">rune</span>(target)\r\n\t\t\t<span class=\"hljs-keyword\">for</span> x := <span class=\"hljs-number\">0</span>; x &lt; <span class=\"hljs-built_in\">len</span>(target); x++ {\r\n\t\t\t\t<span class=\"hljs-keyword\">if</span> itemKey[x] == targetRune[x] {\r\n\t\t\t\t\tpop[i].Value++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tpop[i].Value = pop[i].Value / <span class=\"hljs-type\">float64</span>(<span class=\"hljs-built_in\">len</span>(targetRune))\r\n\t\t}\r\n\t\tsort.SliceStable(pop, <span class=\"hljs-function\"><span class=\"hljs-keyword\">func</span><span class=\"hljs-params\">(i, j <span class=\"hljs-type\">int</span>)</span></span> <span class=\"hljs-type\">bool</span> { <span class=\"hljs-keyword\">return</span> pop[i].Value &gt; pop[j].Value })\r\n\r\n\t\t<span class=\"hljs-comment\">// Check if there is a matching evolution</span>\r\n\t\t<span class=\"hljs-keyword\">if</span> pop[<span class=\"hljs-number\">0</span>].Key == target {\r\n\t\t\t<span class=\"hljs-keyword\">break</span>\r\n\t\t}\r\n\r\n\t\t<span class=\"hljs-comment\">// Print the best resultPrint the Best result every 10 generations</span>\r\n\t\t<span class=\"hljs-comment\">// just to know that the algorithm is working</span>\r\n\t\t<span class=\"hljs-keyword\">if</span> debug &amp;&amp; gen%<span class=\"hljs-number\">10</span> == <span class=\"hljs-number\">0</span> {\r\n\t\t\tfmt.Println(<span class=\"hljs-string\">&quot;Generation:&quot;</span>, strconv.Itoa(gen), <span class=\"hljs-string\">&quot;Analyzed:&quot;</span>, generatedPop, <span class=\"hljs-string\">&quot;Best:&quot;</span>, pop[<span class=\"hljs-number\">0</span>])\r\n\t\t}\r\n\r\n\t\t<span class=\"hljs-comment\">// Generate a new population vector keeping some of the best evolutions</span>\r\n\t\t<span class=\"hljs-comment\">// Keeping this avoid regression of evolution</span>\r\n\t\t<span class=\"hljs-keyword\">var</span> popChildren []PopulationItem\r\n\t\tpopChildren = <span class=\"hljs-built_in\">append</span>(popChildren, pop[<span class=\"hljs-number\">0</span>:<span class=\"hljs-type\">int</span>(selectionNum/<span class=\"hljs-number\">3</span>)]...)\r\n\r\n\t\t<span class=\"hljs-comment\">// This is Selection</span>\r\n\t\t<span class=\"hljs-keyword\">for</span> i := <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-type\">int</span>(selectionNum); i++ {\r\n\t\t\tparent1 := pop[i]\r\n\t\t\t<span class=\"hljs-comment\">// Generate more child proportionally to the fitness score</span>\r\n\t\t\tnChild := (parent1.Value * <span class=\"hljs-number\">100</span>) + <span class=\"hljs-number\">1</span>\r\n\t\t\t<span class=\"hljs-keyword\">if</span> nChild &gt;= <span class=\"hljs-number\">10</span> {\r\n\t\t\t\tnChild = <span class=\"hljs-number\">10</span>\r\n\t\t\t}\r\n\t\t\t<span class=\"hljs-keyword\">for</span> x := <span class=\"hljs-number\">0.0</span>; x &lt; nChild; x++ {\r\n\t\t\t\tparent2 := pop[rand.Intn(selectionNum)]\r\n\t\t\t\t<span class=\"hljs-comment\">// Crossover</span>\r\n\t\t\t\tsplit := rand.Intn(utf8.RuneCountInString(target))\r\n\t\t\t\tchild1 := <span class=\"hljs-built_in\">append</span>([]<span class=\"hljs-type\">rune</span>(parent1.Key)[:split], []<span class=\"hljs-type\">rune</span>(parent2.Key)[split:]...)\r\n\t\t\t\tchild2 := <span class=\"hljs-built_in\">append</span>([]<span class=\"hljs-type\">rune</span>(parent2.Key)[:split], []<span class=\"hljs-type\">rune</span>(parent1.Key)[split:]...)\r\n\t\t\t\t<span class=\"hljs-comment\">// Clean fitness value</span>\r\n\t\t\t\t<span class=\"hljs-comment\">// Mutate</span>\r\n\t\t\t\t<span class=\"hljs-keyword\">if</span> rand.Float64() &lt; mutationProb {\r\n\t\t\t\t\tchild1[rand.Intn(<span class=\"hljs-built_in\">len</span>(child1))] = charmap[rand.Intn(<span class=\"hljs-built_in\">len</span>(charmap))]\r\n\t\t\t\t}\r\n\t\t\t\t<span class=\"hljs-keyword\">if</span> rand.Float64() &lt; mutationProb {\r\n\t\t\t\t\tchild2[rand.Intn(<span class=\"hljs-built_in\">len</span>(child2))] = charmap[rand.Intn(<span class=\"hljs-built_in\">len</span>(charmap))]\r\n\t\t\t\t}\r\n\t\t\t\t<span class=\"hljs-comment\">// Push into &#x27;popChildren&#x27;</span>\r\n\t\t\t\tpopChildren = <span class=\"hljs-built_in\">append</span>(popChildren, PopulationItem{<span class=\"hljs-type\">string</span>(child1), <span class=\"hljs-number\">0</span>})\r\n\t\t\t\tpopChildren = <span class=\"hljs-built_in\">append</span>(popChildren, PopulationItem{<span class=\"hljs-type\">string</span>(child2), <span class=\"hljs-number\">0</span>})\r\n\r\n\t\t\t\t<span class=\"hljs-comment\">// Check if the population has already reached the maximum value and if so,</span>\r\n\t\t\t\t<span class=\"hljs-comment\">// break the cycle. If this check is disabled the algorithm will take</span>\r\n\t\t\t\t<span class=\"hljs-comment\">// forever to compute large strings but will also calculate small string in</span>\r\n\t\t\t\t<span class=\"hljs-comment\">// a lot fewer generations√π</span>\r\n\t\t\t\t<span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(popChildren) &gt;= selectionNum {\r\n\t\t\t\t\t<span class=\"hljs-keyword\">break</span>\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tpop = popChildren\r\n\t}\r\n\t<span class=\"hljs-keyword\">return</span> &amp;Result{gen, generatedPop, pop[<span class=\"hljs-number\">0</span>]}, <span class=\"hljs-literal\">nil</span>\r\n}\r\n"
    }
  },
  "contributors": [
    {
      "name": "Rak Laptudirm",
      "email": "raklaptudirm@gmail.com",
      "commits": 1
    },
    {
      "name": "Abel",
      "email": "abel.tay@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}